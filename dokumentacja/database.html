<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, minimum-scale=1" />
<meta name="generator" content="pdoc 0.9.2" />
<title>Rezerwacje.database API documentation</title>
<meta name="description" content="" />
<link rel="preload stylesheet" as="style" href="https://cdnjs.cloudflare.com/ajax/libs/10up-sanitize.css/11.0.1/sanitize.min.css" integrity="sha256-PK9q560IAAa6WVRRh76LtCaI8pjTJ2z11v0miyNNjrs=" crossorigin>
<link rel="preload stylesheet" as="style" href="https://cdnjs.cloudflare.com/ajax/libs/10up-sanitize.css/11.0.1/typography.min.css" integrity="sha256-7l/o7C8jubJiy74VsKTidCy1yBkRtiUGbVkYBylBqUg=" crossorigin>
<link rel="stylesheet preload" as="style" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.1.1/styles/github.min.css" crossorigin>
<style>:root{--highlight-color:#fe9}.flex{display:flex !important}body{line-height:1.5em}#content{padding:20px}#sidebar{padding:30px;overflow:hidden}#sidebar > *:last-child{margin-bottom:2cm}.http-server-breadcrumbs{font-size:130%;margin:0 0 15px 0}#footer{font-size:.75em;padding:5px 30px;border-top:1px solid #ddd;text-align:right}#footer p{margin:0 0 0 1em;display:inline-block}#footer p:last-child{margin-right:30px}h1,h2,h3,h4,h5{font-weight:300}h1{font-size:2.5em;line-height:1.1em}h2{font-size:1.75em;margin:1em 0 .50em 0}h3{font-size:1.4em;margin:25px 0 10px 0}h4{margin:0;font-size:105%}h1:target,h2:target,h3:target,h4:target,h5:target,h6:target{background:var(--highlight-color);padding:.2em 0}a{color:#058;text-decoration:none;transition:color .3s ease-in-out}a:hover{color:#e82}.title code{font-weight:bold}h2[id^="header-"]{margin-top:2em}.ident{color:#900}pre code{background:#f8f8f8;font-size:.8em;line-height:1.4em}code{background:#f2f2f1;padding:1px 4px;overflow-wrap:break-word}h1 code{background:transparent}pre{background:#f8f8f8;border:0;border-top:1px solid #ccc;border-bottom:1px solid #ccc;margin:1em 0;padding:1ex}#http-server-module-list{display:flex;flex-flow:column}#http-server-module-list div{display:flex}#http-server-module-list dt{min-width:10%}#http-server-module-list p{margin-top:0}.toc ul,#index{list-style-type:none;margin:0;padding:0}#index code{background:transparent}#index h3{border-bottom:1px solid #ddd}#index ul{padding:0}#index h4{margin-top:.6em;font-weight:bold}@media (min-width:200ex){#index .two-column{column-count:2}}@media (min-width:300ex){#index .two-column{column-count:3}}dl{margin-bottom:2em}dl dl:last-child{margin-bottom:4em}dd{margin:0 0 1em 3em}#header-classes + dl > dd{margin-bottom:3em}dd dd{margin-left:2em}dd p{margin:10px 0}.name{background:#eee;font-weight:bold;font-size:.85em;padding:5px 10px;display:inline-block;min-width:40%}.name:hover{background:#e0e0e0}dt:target .name{background:var(--highlight-color)}.name > span:first-child{white-space:nowrap}.name.class > span:nth-child(2){margin-left:.4em}.inherited{color:#999;border-left:5px solid #eee;padding-left:1em}.inheritance em{font-style:normal;font-weight:bold}.desc h2{font-weight:400;font-size:1.25em}.desc h3{font-size:1em}.desc dt code{background:inherit}.source summary,.git-link-div{color:#666;text-align:right;font-weight:400;font-size:.8em;text-transform:uppercase}.source summary > *{white-space:nowrap;cursor:pointer}.git-link{color:inherit;margin-left:1em}.source pre{max-height:500px;overflow:auto;margin:0}.source pre code{font-size:12px;overflow:visible}.hlist{list-style:none}.hlist li{display:inline}.hlist li:after{content:',\2002'}.hlist li:last-child:after{content:none}.hlist .hlist{display:inline;padding-left:1em}img{max-width:100%}td{padding:0 .5em}.admonition{padding:.1em .5em;margin-bottom:1em}.admonition-title{font-weight:bold}.admonition.note,.admonition.info,.admonition.important{background:#aef}.admonition.todo,.admonition.versionadded,.admonition.tip,.admonition.hint{background:#dfd}.admonition.warning,.admonition.versionchanged,.admonition.deprecated{background:#fd4}.admonition.error,.admonition.danger,.admonition.caution{background:lightpink}</style>
<style media="screen and (min-width: 700px)">@media screen and (min-width:700px){#sidebar{width:30%;height:100vh;overflow:auto;position:sticky;top:0}#content{width:70%;max-width:100ch;padding:3em 4em;border-left:1px solid #ddd}pre code{font-size:1em}.item .name{font-size:1em}main{display:flex;flex-direction:row-reverse;justify-content:flex-end}.toc ul ul,#index ul{padding-left:1.5em}.toc > ul > li{margin-top:.5em}}</style>
<style media="print">@media print{#sidebar h1{page-break-before:always}.source{display:none}}@media print{*{background:transparent !important;color:#000 !important;box-shadow:none !important;text-shadow:none !important}a[href]:after{content:" (" attr(href) ")";font-size:90%}a[href][title]:after{content:none}abbr[title]:after{content:" (" attr(title) ")"}.ir a:after,a[href^="javascript:"]:after,a[href^="#"]:after{content:""}pre,blockquote{border:1px solid #999;page-break-inside:avoid}thead{display:table-header-group}tr,img{page-break-inside:avoid}img{max-width:100% !important}@page{margin:0.5cm}p,h2,h3{orphans:3;widows:3}h1,h2,h3,h4,h5,h6{page-break-after:avoid}}</style>
<script defer src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.1.1/highlight.min.js" integrity="sha256-Uv3H6lx7dJmRfRvH8TH6kJD1TSK1aFcwgx+mdg3epi8=" crossorigin></script>
<script>window.addEventListener('DOMContentLoaded', () => hljs.initHighlighting())</script>
</head>
<body>
<main>
<article id="content">
<header>
<h1 class="title">Module <code>Rezerwacje.database</code></h1>
</header>
<section id="section-intro">
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">import psycopg2
import json 

class DataBase():
    def __init__(self):
        &#34;&#34;&#34;inicjalizacja i łączenie się z bazą danych&#34;&#34;&#34;
        database=&#34;wtshrchu&#34;
        username=&#34;wtshrchu&#34;
        password=&#34;UyNLvApGg4xA-K09gJFArm8841DF25jw&#34;
        hostname=&#34;dumbo.db.elephantsql.com&#34;
        port=&#34;5432&#34;
        self.conn = psycopg2.connect(database=database, user=username, password=password, host=hostname, port=port)

    def close_database(self):
        &#34;&#34;&#34;zamknięcie połączenia z bazą&#34;&#34;&#34;
        self.conn.close()

    def handle_errors(self, err):
        &#34;&#34;&#34;cofnięcie operacji w przypadku błędu z triggera i przyjaźniejsze dla użytkownika wyświetlanie komunikatu&#34;&#34;&#34;
        errormessage = str(err.pgerror).split(&#34;CONTEXT&#34;)
        self.conn.rollback()
        return errormessage[0]
    
    def handle_general_errors(self, err):
        &#34;&#34;&#34;cofnięcie operacji w przypadku błędu i przyjaźniejsze dla użytkownika wyświetlanie komunikatu&#34;&#34;&#34;
        errormessage = str(err.pgerror).split(&#34;LINE&#34;)
        self.conn.rollback()
        return errormessage[0]

    def update_reservations(self):
        &#34;&#34;&#34;aktualizacja rezerwacji&#34;&#34;&#34;
        cur = self.conn.cursor()
        try:
            cur.execute(&#34;&#34;&#34;SELECT * FROM aktualizuj_rezerwacje()&#34;&#34;&#34;)
            self.conn.commit()
            message = (True, &#39;Pomyslnie zaktualizowano statusy rezerwacji&#39;)
        except psycopg2.errors.RaiseException as err:
            print(err)
            message = (False, self.handle_errors(err))
        except Exception as err:
            print(err)
            message = (False, self.handle_general_errors(err))
        cur.close()
        return message

    def get_statistics(self):
        &#34;&#34;&#34;odczyt ogólnych statystyk hoteli w bazie&#34;&#34;&#34;
        cur = self.conn.cursor()
        data = {}

        cur.execute(&#34;SELECT min_cena, max_cena FROM min_max_cena;&#34;)
        result = cur.fetchone()
        data.setdefault(&#34;min_cena&#34;, result[0])
        data.setdefault(&#34;max_cena&#34;, result[1])

        cur.execute(&#34;SELECT l_hoteli FROM liczba_hoteli;&#34;)
        result = cur.fetchone()
        data.setdefault(&#34;liczba_hoteli&#34;, result[0])

        cur.execute(&#34;SELECT l_pokoi FROM liczba_pokoi;&#34;)
        result = cur.fetchone()
        data.setdefault(&#34;liczba_pokoi&#34;, result[0])

        cur.close()
        return data

    def get_hotel_statistics(self, id_hotel):
        &#34;&#34;&#34;odczyt statystyk dla hotelu z danym id_hotel&#34;&#34;&#34;
        cur = self.conn.cursor()
        data = {}

        cur.execute(&#34;SELECT min_cena, max_cena FROM min_max_cena_na_hotel WHERE id_hotel=%s;&#34;, (id_hotel,))
        result = cur.fetchone()
        data.setdefault(&#34;min_cena&#34;, result[0])
        data.setdefault(&#34;max_cena&#34;, result[1])

        cur.execute(&#34;SELECT l_pokoi FROM liczba_pokoi_na_hotel WHERE id_hotel=%s;&#34;, (id_hotel,))
        result = cur.fetchone()
        data.setdefault(&#34;liczba_pokoi&#34;, result[0])

        cur.close()
        return data

    def get_guest(self, id_gosc):
        &#34;&#34;&#34;odczyt informacji o danym gościu&#34;&#34;&#34;
        cur = self.conn.cursor()
        cur.execute(&#34;SELECT email, imie, nazwisko, telefon FROM Gosc WHERE id_gosc=%s;&#34;, (id_gosc,))
        result = cur.fetchone()
        data = {&#39;email&#39;:result[0], 
                &#39;imie&#39;:result[1],
                &#39;nazwisko&#39;:result[2], 
                &#39;telefon&#39;:result[3]}
        cur.close()
        return data

    def get_employee(self, id_pracownik):
        &#34;&#34;&#34;odczyt informacji o danym pracowniku&#34;&#34;&#34;
        cur = self.conn.cursor()
        cur.execute(&#34;SELECT email, imie, nazwisko FROM Pracownik WHERE id_pracownik=%s;&#34;, (id_pracownik,))
        result = cur.fetchone()
        data = {&#39;email&#39;:result[0], 
                &#39;imie&#39;:result[1],
                &#39;nazwisko&#39;:result[2]}
        cur.close()
        return data

    def get_attractions(self):
        &#34;&#34;&#34;odczyt wszystkich możliwych atrakcji z bazy danych&#34;&#34;&#34;
        cur = self.conn.cursor()
        cur.execute(&#34;SELECT id_atrakcje, opis FROM Atrakcje;&#34;)
        result = cur.fetchall()
        data = [(x[0], x[1]) for x in result]
        cur.close()
        return data

    def get_status(self):
        &#34;&#34;&#34;odczyt wszystkich możliwych statusów rezerwacji z bazy danych&#34;&#34;&#34;
        cur = self.conn.cursor()
        cur.execute(&#34;SELECT id_status, opis FROM Status;&#34;)
        result = cur.fetchall()
        data = [(x[0], x[1]) for x in result]
        cur.close()
        return data

    def get_equipments(self):
        &#34;&#34;&#34;odczyt wszystkich możliwych wyposażeń pokoju z bazy danych&#34;&#34;&#34;
        cur = self.conn.cursor()
        cur.execute(&#34;SELECT id_wyposazenie, opis FROM Wyposazenie;&#34;)
        result = cur.fetchall()
        data = [(x[0], x[1]) for x in result]
        cur.close()
        return data

    def get_hotel_attractions(self, id_hotel):
        &#34;&#34;&#34;odczyt atrakcji danego hotelu&#34;&#34;&#34;
        cur = self.conn.cursor()
        cur.execute(&#34;SELECT opis, otwarcie, zamkniecie, cena_godzina FROM atrakcje_hotelu WHERE id_hotel=%s;&#34;, (id_hotel,))
        result = cur.fetchall()
        data = [(x[0], x[1], x[2], x[3]) for x in result]
        cur.close()
        return data

    def get_hotels(self):
        &#34;&#34;&#34;odczyt wszystkich hoteli wraz z ich sieciami z bazy danych&#34;&#34;&#34;
        cur = self.conn.cursor()
        cur.execute(&#34;SELECT nazwa_sieci, id_hotel, nazwa, adres, email, telefon, kategoria FROM hotele_sieci;&#34;)
        result = cur.fetchall()
        data = {}
        for x in result:
            data.setdefault(x[0], [])
            data[x[0]].append({&#39;id_hotel&#39;: x[1], &#39;nazwa&#39;:x[2], &#39;adres&#39;:x[3], &#39;email&#39;:x[4], &#39;telefon&#39;:x[5], &#39;kategoria&#39;: x[6]})
        cur.close()
        return data

    def get_filtered_hotels(self, args):
        &#34;&#34;&#34;odczyt wszystkich hoteli wraz z ich sieciami z bazy danych przefiltrowane przez dostępność atrakcji&#34;&#34;&#34;
        cur = self.conn.cursor()
        cur.execute(&#34;SELECT nazwa_sieci, id_hotel, nazwa, adres, email, telefon, kategoria FROM filtruj_atrakcje %s;&#34;, (args,))
        result = cur.fetchall()
        data = {}
        for x in result:
            data.setdefault(x[0], [])
            data[x[0]].append({&#39;id_hotel&#39;: x[1], &#39;nazwa&#39;:x[2], &#39;adres&#39;:x[3], &#39;email&#39;:x[4], &#39;telefon&#39;:x[5], &#39;kategoria&#39;: x[6]})
        self.conn.commit()
        cur.close()
        return data

    def get_filtered_rooms(self, data):
        &#34;&#34;&#34;odczyt wszystkich pokoji z danego hotelu przefiltrowane przez dostępność pokoi&#34;&#34;&#34;
        cur = self.conn.cursor()
        cur.execute(&#34;&#34;&#34;SELECT numer, id_pokoj, nazwa, opis_typu, dla_palaczy, typ_wezlu_higsan, pietro, liczba_miejsc, 
            opis_pokoju, cena, okres_poczatek, okres_koniec FROM filtruj_pokoje(%s,%s,%s);&#34;&#34;&#34;, (data[&#39;data_start&#39;],data[&#39;data_end&#39;], data[&#39;id_hotel&#39;]))
        result = cur.fetchall()
        data = {}
        for x in result:
            data.setdefault(x[0], [])
            data[x[0]].append({&#39;numer&#39;: x[0], &#39;id_pokoj&#39;:x[1], &#39;nazwa&#39;:x[2], &#39;opis_typu&#39;:x[3], &#39;dla_palaczy&#39;:x[4],
            &#39;typ_wezlu_higsan&#39;:x[5], &#39;pietro&#39;:x[6], &#39;liczba_miejsc&#39;:x[7], &#39;opis_pokoju&#39;:x[8], &#39;cena&#39;:x[9], &#39;okres_poczatek&#39;:x[10],
            &#39;okres_koniec&#39;:x[11]})
        cur.close()
        return data

    def get_room_availability(self, id_pokoj):
        &#34;&#34;&#34;odczyt wolnych terminów pokoju&#34;&#34;&#34;
        cur = self.conn.cursor()
        cur.execute(&#34;SELECT data_poczatku, data_konca FROM terminy_pokoju WHERE id_pokoj=%s;&#34;, (id_pokoj,))
        result = cur.fetchall()
        data = []
        for x in result:
            data.append({&#39;data_poczatku&#39;: x[0], &#39;data_konca&#39;:x[1]})
        cur.close()
        return data

    def get_calculated_price(self, data):
        &#34;&#34;&#34;odczyt wyliczonej przez bazę kwoty za dany pobyt&#34;&#34;&#34;
        cur = self.conn.cursor()
        cur.execute(&#34;SELECT * FROM wylicz_cene(%s, %s, %s);&#34;, (data[&#39;data_poczatku&#39;], data[&#39;data_konca&#39;], data[&#39;id_pokoj&#39;]))
        result = cur.fetchone()[0]
        cur.close()
        return result

    def get_guest_reservations(self, id_gosc):
        &#34;&#34;&#34;odczyt wszystkich rezerwacji złożonych przez danego gościa&#34;&#34;&#34;
        cur = self.conn.cursor()
        cur.execute(&#34;&#34;&#34;SELECT id_rezerwacja, id_pokoj, data_poczatku, data_konca, data_rezerwacji, opis 
                FROM rezerwacje_goscia WHERE id_gosc=%s AND r=1;&#34;&#34;&#34;, (id_gosc,))
        result = cur.fetchall()
        data = {}
        for x in result:
            data.setdefault(x[0], {&#39;id_pokoj&#39;:x[1], &#39;data_poczatku&#39;:x[2], &#39;data_konca&#39;:x[3], &#39;data_rezerwacji&#39;:x[4], &#39;opis&#39;:x[5]})
        cur.close()
        return data

    def get_hotel_reservations(self, id_hotel):
        &#34;&#34;&#34;odczyt wszystkich rezerwacji złożonych w danym hotelu&#34;&#34;&#34;
        cur = self.conn.cursor()
        cur.execute(&#34;&#34;&#34;SELECT id_rezerwacja, id_pokoj, data_poczatku, data_konca, data_rezerwacji, opis, id_gosc, email
                FROM rezerwacje_hotelu WHERE id_hotel=%s AND r=1;&#34;&#34;&#34;, (id_hotel,))
        result = cur.fetchall()
        data = {}
        for x in result:
            data.setdefault(x[0], {&#39;id_pokoj&#39;:x[1], &#39;data_poczatku&#39;:x[2], &#39;data_konca&#39;:x[3], &#39;data_rezerwacji&#39;:x[4], &#39;opis&#39;:x[5], &#39;id_gosc&#39;:x[6], &#39;email&#39;:x[7]})
        cur.close()
        return data

    def get_filtered_hotel_reservations(self, id_hotel, email):
        &#34;&#34;&#34;odczyt wszystkich rezerwacji złożonych w danym hotelu przez gościa o danym adresie email&#34;&#34;&#34;
        cur = self.conn.cursor()
        cur.execute(&#34;&#34;&#34;SELECT id_rezerwacja, id_pokoj, data_poczatku, data_konca, data_rezerwacji, opis, id_gosc, email
                FROM rezerwacje_hotelu WHERE id_hotel=%s AND LOWER(email)=LOWER(%s) AND r=1;&#34;&#34;&#34;, (id_hotel,email))
        result = cur.fetchall()
        data = {}
        for x in result:
            data.setdefault(x[0], {&#39;id_pokoj&#39;:x[1], &#39;data_poczatku&#39;:x[2], &#39;data_konca&#39;:x[3], &#39;data_rezerwacji&#39;:x[4],&#39;opis&#39;:x[5], &#39;id_gosc&#39;:x[6], &#39;email&#39;:x[7]})
        cur.close()
        return data

    def get_rooms(self, id_hotel):
        &#34;&#34;&#34;odczyt wszystkich pokoi z danego hotelu&#34;&#34;&#34;
        cur = self.conn.cursor()
        cur.execute(&#34;&#34;&#34;SELECT numer, id_pokoj, nazwa, opis_typu, dla_palaczy, typ_wezlu_higsan, pietro, liczba_miejsc, 
            opis_pokoju, cena, okres_poczatek, okres_koniec FROM pokoje_hotelu WHERE id_hotel=%s;&#34;&#34;&#34;, (id_hotel,))
        result = cur.fetchall()
        data = {}
        for x in result:
            data.setdefault(x[0], [])
            data[x[0]].append({&#39;numer&#39;: x[0], &#39;id_pokoj&#39;:x[1], &#39;nazwa&#39;:x[2], &#39;opis_typu&#39;:x[3], &#39;dla_palaczy&#39;:x[4],
            &#39;typ_wezlu_higsan&#39;:x[5], &#39;pietro&#39;:x[6], &#39;liczba_miejsc&#39;:x[7], &#39;opis_pokoju&#39;:x[8], &#39;cena&#39;:x[9], &#39;okres_poczatek&#39;:x[10],
            &#39;okres_koniec&#39;:x[11]})
        cur.close()
        return data

    def get_chains(self):
        &#34;&#34;&#34;odczyt wszystkich sieci w bazie&#34;&#34;&#34;
        cur = self.conn.cursor()
        cur.execute(&#34;SELECT id_siec, nazwa FROM Siec;&#34;)
        result = cur.fetchall()
        data = {}
        for x in result:
            data.setdefault(x[0],{&#39;nazwa&#39;: x[1]})
        cur.close()
        return data
    
    def get_types(self, id_hotel):
        &#34;&#34;&#34;odczyt typów pokoju&#34;&#34;&#34;
        cur = self.conn.cursor()
        cur.execute(&#34;SELECT id_typ, nazwa, opis_pokoju, dla_palaczy, typ_wezlu_higsan, ilosc, opis_wyposazenia FROM typy_pokojow WHERE id_hotel=%s;&#34;, (id_hotel,))
        result = cur.fetchall()
        data = {}
        for x in result:
            data.setdefault(x[0], {&#39;id_typ&#39;: x[0], &#39;nazwa&#39; : x[1], &#39;opis_pokoju&#39; : x[2], &#39;dla_palaczy&#39; : x[3],
            &#39;typ_wezlu_higsan&#39; : x[4], &#39;wyposazenie&#39;:[]})
            data[x[0]][&#39;wyposazenie&#39;].append({&#39;ilosc&#39;: x[5], &#39;opis_wyposazenia&#39; : x[6]})
        cur.close()
        return data

    def get_room_equipments(self, id_pokoj):
        &#34;&#34;&#34;odczyt wyposażenia danego pokoju&#34;&#34;&#34;
        cur = self.conn.cursor()
        cur.execute(&#34;SELECT ilosc, opis FROM wyposazenie_pokoju WHERE id_pokoj=%s;&#34;, (id_pokoj,))
        result = cur.fetchall()
        data = []
        for x in result:
            data.append({&#39;ilosc&#39;: x[0], &#39;opis&#39; : x[1]})
        cur.close()
        return data

    def add_guest(self, data):
        &#34;&#34;&#34;rejestracja gościa w bazie&#34;&#34;&#34;
        cur = self.conn.cursor()
        try:
            cur.execute(&#34;INSERT INTO Gosc ( email, haslo, imie, nazwisko, telefon ) VALUES (%s, crypt(%s, gen_salt(&#39;bf&#39;)), %s, %s, %s);&#34;,
                    (data[&#39;email&#39;], data[&#39;haslo&#39;], data[&#39;imie&#39;], data[&#39;nazwisko&#39;], data[&#39;telefon&#39;]))
            message = (True,&#34;Pomyslnie zarejestrowano&#34;)
            self.conn.commit()
        except psycopg2.errors.RaiseException as err:
            print(err)
            message = (False, self.handle_errors(err))
        except Exception as err:
            print(err)
            message = (False, self.handle_general_errors(err))
        cur.close()
        return message

    def update_guest(self, data, id_gosc):
        &#34;&#34;&#34;edycja danych gościa o danym id_gosc&#34;&#34;&#34;
        cur = self.conn.cursor()
        try:
            if data[&#39;email&#39;]:
                cur.execute(&#34;UPDATE Gosc SET email = %s WHERE id_gosc = %s&#34;, (data[&#39;email&#39;], id_gosc))
                self.conn.commit()
            if data[&#39;haslo&#39;]:
                cur.execute(&#34;UPDATE Gosc SET haslo = crypt(%s, gen_salt(&#39;bf&#39;)) WHERE id_gosc = %s&#34;, (data[&#39;haslo&#39;], id_gosc))
                self.conn.commit()
            if data[&#39;imie&#39;]:
                cur.execute(&#34;UPDATE Gosc SET imie = %s WHERE id_gosc = %s&#34;, (data[&#39;imie&#39;], id_gosc))
                self.conn.commit()
            if data[&#39;nazwisko&#39;]:
                cur.execute(&#34;UPDATE Gosc SET nazwisko = %s WHERE id_gosc = %s&#34;, (data[&#39;nazwisko&#39;], id_gosc))
                self.conn.commit()
            if data[&#39;telefon&#39;]:
                cur.execute(&#34;UPDATE Gosc SET telefon = %s WHERE id_gosc = %s&#34;, (data[&#39;telefon&#39;], id_gosc))
                self.conn.commit()
            message = (True,&#34;Pomyslnie edytowano dane&#34;)
        except psycopg2.errors.RaiseException as err:
            print(err)
            message = (False, self.handle_errors(err))
        except Exception as err:
            print(err)
            message = (False, self.handle_general_errors(err))
        cur.close()
        return message

    def add_employee(self, data):
        &#34;&#34;&#34;rejestracja pracownika&#34;&#34;&#34;
        cur = self.conn.cursor()
        try:
            cur.execute(&#34;&#34;&#34;INSERT INTO Pracownik ( id_hotel, email, haslo, imie, nazwisko) 
                    VALUES (%s, %s, crypt(%s, gen_salt(&#39;bf&#39;)), %s, %s);&#34;&#34;&#34;, 
                    (data[&#39;id_hotel&#39;], data[&#39;email&#39;], data[&#39;haslo&#39;], data[&#39;imie&#39;], data[&#39;nazwisko&#39;]))
            message = (True,&#34;Pomyslnie dodano pracownika&#34;)
            self.conn.commit()
        except psycopg2.errors.RaiseException as err:
            print(err)
            message = (False, self.handle_errors(err))
        except Exception as err:
            print(err)
            message = (False, self.handle_general_errors(err))
        cur.close()
        return message

    def update_employee(self, data, id_pracownik):
        &#34;&#34;&#34;edycja danych pracownika o danym id_pracownik&#34;&#34;&#34;
        cur = self.conn.cursor()
        try:
            if data[&#39;email&#39;]:
                cur.execute(&#34;UPDATE Pracownik SET email = %s WHERE id_pracownik = %s&#34;, (data[&#39;email&#39;], id_pracownik))
                self.conn.commit()
            if data[&#39;haslo&#39;]:
                cur.execute(&#34;UPDATE Pracownik SET haslo = crypt(%s, gen_salt(&#39;bf&#39;)) WHERE id_pracownik = %s&#34;, (data[&#39;haslo&#39;], id_pracownik))
                self.conn.commit()
            if data[&#39;imie&#39;]:
                cur.execute(&#34;UPDATE Pracownik SET imie = %s WHERE id_pracownik = %s&#34;, (data[&#39;imie&#39;], id_pracownik))
                self.conn.commit()
            if data[&#39;nazwisko&#39;]:
                cur.execute(&#34;UPDATE Pracownik SET nazwisko = %s WHERE id_pracownik = %s&#34;, (data[&#39;nazwisko&#39;], id_pracownik))
                self.conn.commit()
            message = (True,&#34;Pomyslnie edytowano dane&#34;)
        except psycopg2.errors.RaiseException as err:
            print(err)
            message = (False, self.handle_errors(err))
        except Exception as err:
            print(err)
            message = (False, self.handle_general_errors(err))
        cur.close()
        return message

    def login_user(self, data):
        &#34;&#34;&#34;sprawdzanie poprawności logowania użytkownika&#34;&#34;&#34;
        cur = self.conn.cursor()
        cur.execute(&#34;SELECT id_gosc FROM Gosc WHERE email=%s AND haslo = crypt(%s, haslo);&#34;, (data[&#39;email&#39;], data[&#39;haslo&#39;]))
        result = cur.fetchone()
        if result:
            cur.close()
            return (True, False, result[0])
        else:
            cur.execute(&#34;SELECT id_hotel, id_pracownik FROM Pracownik WHERE email=%s AND haslo = crypt(%s, haslo);&#34;, (data[&#39;email&#39;], data[&#39;haslo&#39;]))
            result = cur.fetchone()
            if result:
                cur.close()
                return (True, True, result[0], result[1])
        cur.close()
        return (False, False)

    def logout(self):
        &#34;&#34;&#34;wylogowanie użytkownika, czyli usunięcie obecnego user_id z bazy&#34;&#34;&#34;
        cur = self.conn.cursor()
        cur.execute(&#34;SET public.user_id TO DEFAULT;&#34;)
        self.conn.commit()
        cur.close()

    def add_guest_reservation(self, data):
        &#34;&#34;&#34;dodawanie rezerwacji przez gościa&#34;&#34;&#34;
        cur = self.conn.cursor()
        cur.execute(&#34;SET public.user_id = %s&#34;, (data[&#39;id_gosc&#39;],))
        try:
            cur.execute(&#34;&#34;&#34;INSERT INTO Rezerwacja (id_pokoj, data_poczatku, data_konca, data_rezerwacji) 
                VALUES (%s, %s, %s, CURRENT_DATE);&#34;&#34;&#34;, (data[&#39;id_pokoj&#39;],data[&#39;data_poczatku&#39;], data[&#39;data_konca&#39;]))
            message = (True, &#34;Pomyslnie zlozono rezerwacje&#34;)
            self.conn.commit()
        except psycopg2.errors.RaiseException as err:
            print(err)
            message = (False, self.handle_errors(err))
        except Exception as err:
            print(err)
            message = (False, self.handle_general_errors(err))
        cur.close()
        return message

    def cancel_guest_reservation(self, data):
        &#34;&#34;&#34;anulowanie danej rezerwacji przez gościa&#34;&#34;&#34;
        cur = self.conn.cursor()
        try:
            cur.execute(&#34;SELECT * FROM anuluj_rezerwacje(%s);&#34;, (data,))
            message = (True, &#34;Pomyslnie anulowano rezerwacje&#34;)
            self.conn.commit()
        except psycopg2.errors.RaiseException as err:
            print(err)
            message = (False, self.handle_errors(err))
        except Exception as err:
            print(err)
            message = (False, self.handle_general_errors(err))
        cur.close()
        return message

    def pay_guest_reservation(self, data):
        &#34;&#34;&#34;zapłacanie za daną rezerwacje przez gościa&#34;&#34;&#34;
        cur = self.conn.cursor()
        try:
            cur.execute(&#34;INSERT INTO Status_rezerwacji (id_rezerwacja, data_zmiany_stanu, id_status) VALUES (%s, CURRENT_DATE, 2);&#34;, (data,))
            message = (True, &#34;Pomyslnie zaplacono za rezerwacje&#34;)
            self.conn.commit()
        except psycopg2.errors.RaiseException as err:
            print(err)
            message = (False, self.handle_errors(err))
        except Exception as err:
            print(err)
            message = (False, self.handle_general_errors(err))
        cur.close()
        return message

    def change_guest_reservation(self, data):
        &#34;&#34;&#34;zmiana statusu danej rezerwacji przez pracownika&#34;&#34;&#34;
        cur = self.conn.cursor()
        try:
            cur.execute(&#34;INSERT INTO Status_rezerwacji (id_rezerwacja, data_zmiany_stanu, id_status) VALUES (%s, CURRENT_DATE, %s);&#34;, 
                (data[&#39;id_rezerwacja&#39;],data[&#39;id_status&#39;]))
            message = (True, &#34;Pomyslnie zmieniono status rezerwacji&#34;)
            self.conn.commit()
        except psycopg2.errors.RaiseException as err:
            print(err)
            message = (False, self.handle_errors(err))
        except Exception as err:
            print(err)
            message = (False, self.handle_general_errors(err))
        cur.close()
        return message

    def add_chain(self, data):
        &#34;&#34;&#34;dodawanie sieci do bazy&#34;&#34;&#34;
        cur = self.conn.cursor()
        try:
            cur.execute(&#34;INSERT INTO Siec (nazwa) VALUES (%s);&#34;, (data[&#39;nazwa&#39;],))
            message = (True, &#34;Pomyslnie dodano siec&#34;)
            self.conn.commit()
        except psycopg2.errors.RaiseException as err:
            print(err)
            message = (False, self.handle_errors(err))
        except Exception as err:
            print(err)
            message = (False, self.handle_general_errors(err))
        cur.close()
        return message
    
    def add_hotel(self, data):
        &#34;&#34;&#34;dodawanie hotelu do bazy&#34;&#34;&#34;
        cur = self.conn.cursor()
        try:
            cur.execute(&#34;INSERT INTO Hotel (id_siec, nazwa, telefon, email, kategoria, adres) VALUES (%s, %s, %s, %s, %s, %s);&#34;,
                (data[&#39;id_siec&#39;], data[&#39;nazwa&#39;],data[&#39;telefon&#39;], data[&#39;email&#39;],data[&#39;kategoria&#39;], data[&#39;adres&#39;]))
            message = (True, &#34;Pomyslnie dodano hotel&#34;)
            self.conn.commit()
        except psycopg2.errors.RaiseException as err:
            print(err)
            message = (False, self.handle_errors(err))
        except Exception as err:
            print(err)
            message = (False, self.handle_general_errors(err))
        cur.close()
        return message

    def add_attraction(self, data):
        &#34;&#34;&#34;dodawanie atrakcji do bazy&#34;&#34;&#34;
        cur = self.conn.cursor()
        try:
            cur.execute(&#34;INSERT INTO Atrakcje (opis) VALUES (%s);&#34;, (data[&#39;opis&#39;],))
            message = (True, &#34;Pomyslnie dodano atrakcje&#34;)
            self.conn.commit()
        except psycopg2.errors.RaiseException as err:
            print(err)
            message = (False, self.handle_errors(err))
        except Exception as err:
            print(err)
            message = (False, self.handle_general_errors(err))
        cur.close()
        return message

    def add_equipment(self, data):
        &#34;&#34;&#34;dodawanie wyposażenia do bazy&#34;&#34;&#34;
        cur = self.conn.cursor()
        try:
            cur.execute(&#34;INSERT INTO Wyposazenie (opis) VALUES (%s);&#34;, (data[&#39;opis&#39;],))
            message = (True, &#34;Pomyslnie dodano wyposazenie&#34;)
            self.conn.commit()
        except psycopg2.errors.RaiseException as err:
            print(err)
            message = (False, self.handle_errors(err))
        except Exception as err:
            print(err)
            message = (False, self.handle_general_errors(err))
        cur.close()
        return message

    def add_equipment_to_type(self, data):
        &#34;&#34;&#34;przypisywanie wyposażenia do danego typu pokoju&#34;&#34;&#34;
        cur = self.conn.cursor()
        try:
            cur.execute(&#34;INSERT INTO typ_wyp (id_typ, id_wyposazenie, ilosc) VALUES (%s,%s,%s);&#34;,
                (data[&#39;id_typ&#39;],data[&#39;id_wyposazenie&#39;],data[&#39;ilosc&#39;]))
            message = (True, &#34;Pomyslnie dodano wyposazenie do typu&#34;)
            self.conn.commit()
        except psycopg2.errors.RaiseException as err:
            print(err)
            message = (False, self.handle_errors(err))
        except Exception as err:
            print(err)
            message = (False, self.handle_general_errors(err))
        cur.close()
        return message 

    def add_price_to_type(self, data):
        &#34;&#34;&#34;dodawanie ceny do danego typu pokoju&#34;&#34;&#34;
        cur = self.conn.cursor()
        try:
            cur.execute(&#34;INSERT INTO Cena_dzien (id_typ, cena, okres_poczatek, okres_koniec) VALUES (%s,%s,%s,%s);&#34;,
                (data[&#39;id_typ&#39;],data[&#39;cena&#39;],data[&#39;okres_poczatek&#39;],data[&#39;okres_koniec&#39;]))
            message = (True, &#34;Pomyslnie dodano cene do typu&#34;)
            self.conn.commit()
        except psycopg2.errors.RaiseException as err:
            print(err)
            message = (False, self.handle_errors(err))
        except Exception as err:
            print(err)
            message = (False, self.handle_general_errors(err))
        cur.close()
        return message 

    def add_attraction_to_hotel(self, data):
        &#34;&#34;&#34;przypisywanie atrakcji do danego hotelu&#34;&#34;&#34;
        cur = self.conn.cursor()
        try:
            cur.execute(&#34;INSERT INTO hot_atr (id_hotel, id_atrakcje, otwarcie, zamkniecie, cena_godzina) VALUES (%s,%s,%s,%s,%s);&#34;,
                (data[&#39;id_hotel&#39;],data[&#39;id_atrakcje&#39;],data[&#39;otwarcie&#39;],data[&#39;zamkniecie&#39;],data[&#39;cena_godzina&#39;]))
            message = (True, &#34;Pomyslnie dodano atrakcje do hotelu&#34;)
            self.conn.commit()
        except psycopg2.errors.RaiseException as err:
            print(err)
            message = (False, self.handle_errors(err))
        except Exception as err:
            print(err)
            message = (False, self.handle_general_errors(err))
        cur.close()
        return message 

    def add_room(self, data):
        &#34;&#34;&#34;dodawanie pokoju dla danego typu&#34;&#34;&#34;
        cur = self.conn.cursor()
        try:
            cur.execute(&#34;INSERT INTO Pokoj (id_typ, pietro, numer, liczba_miejsc, opis) VALUES (%s,%s,%s,%s,%s);&#34;, 
                (data[&#39;id_typ&#39;],data[&#39;pietro&#39;],data[&#39;numer&#39;],data[&#39;liczba_miejsc&#39;],data[&#39;opis&#39;]))
            message = (True, &#34;Pomyslnie dodano pokoj&#34;)
            self.conn.commit()
        except psycopg2.errors.RaiseException as err:
            print(err)
            message = (False, self.handle_errors(err))
        except Exception as err:
            print(err)
            message = (False, self.handle_general_errors(err))
        cur.close()
        return message

    def add_type(self, data):
        &#34;&#34;&#34;dodawanie typu pokoju dla danego hotelu&#34;&#34;&#34;
        cur = self.conn.cursor()
        try:
            cur.execute(&#34;INSERT INTO Typ_pokoju (id_hotel, nazwa, opis, dla_palaczy, typ_wezlu_higsan) VALUES (%s, %s,%s,%s,%s);&#34;, 
                (data[&#39;id_hotel&#39;], data[&#39;nazwa&#39;],data[&#39;opis&#39;],data[&#39;dla_palaczy&#39;],data[&#39;typ_wezlu_higsan&#39;]))
            message = (True, &#34;Pomyslnie dodano typ pokoju&#34;)
            self.conn.commit()
        except psycopg2.errors.RaiseException as err:
            print(err)
            message = (False, self.handle_errors(err))
        except Exception as err:
            print(err)
            message = (False, self.handle_general_errors(err))
        cur.close()
        return message

    def input_from_file(self, filename, table):
        &#34;&#34;&#34;pomocnicza funkcja wstawiająca dane z pliku json&#34;&#34;&#34;
        f = open(filename, encoding=&#34;utf-8&#34;) 
        file_input = json.load(f)
        f.close()
        cur = self.conn.cursor()
        for i in range(len(file_input)):
            key = file_input[i].keys()
            keys = &#39;, &#39;.join(key)
            vals = [&#39;%s&#39; for i in range(len(key))]
            vals = &#39;, &#39;.join(vals)
            SQL = f&#34;INSERT INTO {table} ( {keys} ) VALUES ( {vals} );&#34;
            data = tuple([value for key, value in file_input[i].items()])
            print(SQL, data)
            cur.execute(SQL, data)
            self.conn.commit()
        cur.close()</code></pre>
</details>
</section>
<section>
</section>
<section>
</section>
<section>
</section>
<section>
<h2 class="section-title" id="header-classes">Classes</h2>
<dl>
<dt id="Rezerwacje.database.DataBase"><code class="flex name class">
<span>class <span class="ident">DataBase</span></span>
</code></dt>
<dd>
<div class="desc"><p>inicjalizacja i łączenie się z bazą danych</p></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">class DataBase():
    def __init__(self):
        &#34;&#34;&#34;inicjalizacja i łączenie się z bazą danych&#34;&#34;&#34;
        database=&#34;wtshrchu&#34;
        username=&#34;wtshrchu&#34;
        password=&#34;UyNLvApGg4xA-K09gJFArm8841DF25jw&#34;
        hostname=&#34;dumbo.db.elephantsql.com&#34;
        port=&#34;5432&#34;
        self.conn = psycopg2.connect(database=database, user=username, password=password, host=hostname, port=port)

    def close_database(self):
        &#34;&#34;&#34;zamknięcie połączenia z bazą&#34;&#34;&#34;
        self.conn.close()

    def handle_errors(self, err):
        &#34;&#34;&#34;cofnięcie operacji w przypadku błędu z triggera i przyjaźniejsze dla użytkownika wyświetlanie komunikatu&#34;&#34;&#34;
        errormessage = str(err.pgerror).split(&#34;CONTEXT&#34;)
        self.conn.rollback()
        return errormessage[0]
    
    def handle_general_errors(self, err):
        &#34;&#34;&#34;cofnięcie operacji w przypadku błędu i przyjaźniejsze dla użytkownika wyświetlanie komunikatu&#34;&#34;&#34;
        errormessage = str(err.pgerror).split(&#34;LINE&#34;)
        self.conn.rollback()
        return errormessage[0]

    def update_reservations(self):
        &#34;&#34;&#34;aktualizacja rezerwacji&#34;&#34;&#34;
        cur = self.conn.cursor()
        try:
            cur.execute(&#34;&#34;&#34;SELECT * FROM aktualizuj_rezerwacje()&#34;&#34;&#34;)
            self.conn.commit()
            message = (True, &#39;Pomyslnie zaktualizowano statusy rezerwacji&#39;)
        except psycopg2.errors.RaiseException as err:
            print(err)
            message = (False, self.handle_errors(err))
        except Exception as err:
            print(err)
            message = (False, self.handle_general_errors(err))
        cur.close()
        return message

    def get_statistics(self):
        &#34;&#34;&#34;odczyt ogólnych statystyk hoteli w bazie&#34;&#34;&#34;
        cur = self.conn.cursor()
        data = {}

        cur.execute(&#34;SELECT min_cena, max_cena FROM min_max_cena;&#34;)
        result = cur.fetchone()
        data.setdefault(&#34;min_cena&#34;, result[0])
        data.setdefault(&#34;max_cena&#34;, result[1])

        cur.execute(&#34;SELECT l_hoteli FROM liczba_hoteli;&#34;)
        result = cur.fetchone()
        data.setdefault(&#34;liczba_hoteli&#34;, result[0])

        cur.execute(&#34;SELECT l_pokoi FROM liczba_pokoi;&#34;)
        result = cur.fetchone()
        data.setdefault(&#34;liczba_pokoi&#34;, result[0])

        cur.close()
        return data

    def get_hotel_statistics(self, id_hotel):
        &#34;&#34;&#34;odczyt statystyk dla hotelu z danym id_hotel&#34;&#34;&#34;
        cur = self.conn.cursor()
        data = {}

        cur.execute(&#34;SELECT min_cena, max_cena FROM min_max_cena_na_hotel WHERE id_hotel=%s;&#34;, (id_hotel,))
        result = cur.fetchone()
        data.setdefault(&#34;min_cena&#34;, result[0])
        data.setdefault(&#34;max_cena&#34;, result[1])

        cur.execute(&#34;SELECT l_pokoi FROM liczba_pokoi_na_hotel WHERE id_hotel=%s;&#34;, (id_hotel,))
        result = cur.fetchone()
        data.setdefault(&#34;liczba_pokoi&#34;, result[0])

        cur.close()
        return data

    def get_guest(self, id_gosc):
        &#34;&#34;&#34;odczyt informacji o danym gościu&#34;&#34;&#34;
        cur = self.conn.cursor()
        cur.execute(&#34;SELECT email, imie, nazwisko, telefon FROM Gosc WHERE id_gosc=%s;&#34;, (id_gosc,))
        result = cur.fetchone()
        data = {&#39;email&#39;:result[0], 
                &#39;imie&#39;:result[1],
                &#39;nazwisko&#39;:result[2], 
                &#39;telefon&#39;:result[3]}
        cur.close()
        return data

    def get_employee(self, id_pracownik):
        &#34;&#34;&#34;odczyt informacji o danym pracowniku&#34;&#34;&#34;
        cur = self.conn.cursor()
        cur.execute(&#34;SELECT email, imie, nazwisko FROM Pracownik WHERE id_pracownik=%s;&#34;, (id_pracownik,))
        result = cur.fetchone()
        data = {&#39;email&#39;:result[0], 
                &#39;imie&#39;:result[1],
                &#39;nazwisko&#39;:result[2]}
        cur.close()
        return data

    def get_attractions(self):
        &#34;&#34;&#34;odczyt wszystkich możliwych atrakcji z bazy danych&#34;&#34;&#34;
        cur = self.conn.cursor()
        cur.execute(&#34;SELECT id_atrakcje, opis FROM Atrakcje;&#34;)
        result = cur.fetchall()
        data = [(x[0], x[1]) for x in result]
        cur.close()
        return data

    def get_status(self):
        &#34;&#34;&#34;odczyt wszystkich możliwych statusów rezerwacji z bazy danych&#34;&#34;&#34;
        cur = self.conn.cursor()
        cur.execute(&#34;SELECT id_status, opis FROM Status;&#34;)
        result = cur.fetchall()
        data = [(x[0], x[1]) for x in result]
        cur.close()
        return data

    def get_equipments(self):
        &#34;&#34;&#34;odczyt wszystkich możliwych wyposażeń pokoju z bazy danych&#34;&#34;&#34;
        cur = self.conn.cursor()
        cur.execute(&#34;SELECT id_wyposazenie, opis FROM Wyposazenie;&#34;)
        result = cur.fetchall()
        data = [(x[0], x[1]) for x in result]
        cur.close()
        return data

    def get_hotel_attractions(self, id_hotel):
        &#34;&#34;&#34;odczyt atrakcji danego hotelu&#34;&#34;&#34;
        cur = self.conn.cursor()
        cur.execute(&#34;SELECT opis, otwarcie, zamkniecie, cena_godzina FROM atrakcje_hotelu WHERE id_hotel=%s;&#34;, (id_hotel,))
        result = cur.fetchall()
        data = [(x[0], x[1], x[2], x[3]) for x in result]
        cur.close()
        return data

    def get_hotels(self):
        &#34;&#34;&#34;odczyt wszystkich hoteli wraz z ich sieciami z bazy danych&#34;&#34;&#34;
        cur = self.conn.cursor()
        cur.execute(&#34;SELECT nazwa_sieci, id_hotel, nazwa, adres, email, telefon, kategoria FROM hotele_sieci;&#34;)
        result = cur.fetchall()
        data = {}
        for x in result:
            data.setdefault(x[0], [])
            data[x[0]].append({&#39;id_hotel&#39;: x[1], &#39;nazwa&#39;:x[2], &#39;adres&#39;:x[3], &#39;email&#39;:x[4], &#39;telefon&#39;:x[5], &#39;kategoria&#39;: x[6]})
        cur.close()
        return data

    def get_filtered_hotels(self, args):
        &#34;&#34;&#34;odczyt wszystkich hoteli wraz z ich sieciami z bazy danych przefiltrowane przez dostępność atrakcji&#34;&#34;&#34;
        cur = self.conn.cursor()
        cur.execute(&#34;SELECT nazwa_sieci, id_hotel, nazwa, adres, email, telefon, kategoria FROM filtruj_atrakcje %s;&#34;, (args,))
        result = cur.fetchall()
        data = {}
        for x in result:
            data.setdefault(x[0], [])
            data[x[0]].append({&#39;id_hotel&#39;: x[1], &#39;nazwa&#39;:x[2], &#39;adres&#39;:x[3], &#39;email&#39;:x[4], &#39;telefon&#39;:x[5], &#39;kategoria&#39;: x[6]})
        self.conn.commit()
        cur.close()
        return data

    def get_filtered_rooms(self, data):
        &#34;&#34;&#34;odczyt wszystkich pokoji z danego hotelu przefiltrowane przez dostępność pokoi&#34;&#34;&#34;
        cur = self.conn.cursor()
        cur.execute(&#34;&#34;&#34;SELECT numer, id_pokoj, nazwa, opis_typu, dla_palaczy, typ_wezlu_higsan, pietro, liczba_miejsc, 
            opis_pokoju, cena, okres_poczatek, okres_koniec FROM filtruj_pokoje(%s,%s,%s);&#34;&#34;&#34;, (data[&#39;data_start&#39;],data[&#39;data_end&#39;], data[&#39;id_hotel&#39;]))
        result = cur.fetchall()
        data = {}
        for x in result:
            data.setdefault(x[0], [])
            data[x[0]].append({&#39;numer&#39;: x[0], &#39;id_pokoj&#39;:x[1], &#39;nazwa&#39;:x[2], &#39;opis_typu&#39;:x[3], &#39;dla_palaczy&#39;:x[4],
            &#39;typ_wezlu_higsan&#39;:x[5], &#39;pietro&#39;:x[6], &#39;liczba_miejsc&#39;:x[7], &#39;opis_pokoju&#39;:x[8], &#39;cena&#39;:x[9], &#39;okres_poczatek&#39;:x[10],
            &#39;okres_koniec&#39;:x[11]})
        cur.close()
        return data

    def get_room_availability(self, id_pokoj):
        &#34;&#34;&#34;odczyt wolnych terminów pokoju&#34;&#34;&#34;
        cur = self.conn.cursor()
        cur.execute(&#34;SELECT data_poczatku, data_konca FROM terminy_pokoju WHERE id_pokoj=%s;&#34;, (id_pokoj,))
        result = cur.fetchall()
        data = []
        for x in result:
            data.append({&#39;data_poczatku&#39;: x[0], &#39;data_konca&#39;:x[1]})
        cur.close()
        return data

    def get_calculated_price(self, data):
        &#34;&#34;&#34;odczyt wyliczonej przez bazę kwoty za dany pobyt&#34;&#34;&#34;
        cur = self.conn.cursor()
        cur.execute(&#34;SELECT * FROM wylicz_cene(%s, %s, %s);&#34;, (data[&#39;data_poczatku&#39;], data[&#39;data_konca&#39;], data[&#39;id_pokoj&#39;]))
        result = cur.fetchone()[0]
        cur.close()
        return result

    def get_guest_reservations(self, id_gosc):
        &#34;&#34;&#34;odczyt wszystkich rezerwacji złożonych przez danego gościa&#34;&#34;&#34;
        cur = self.conn.cursor()
        cur.execute(&#34;&#34;&#34;SELECT id_rezerwacja, id_pokoj, data_poczatku, data_konca, data_rezerwacji, opis 
                FROM rezerwacje_goscia WHERE id_gosc=%s AND r=1;&#34;&#34;&#34;, (id_gosc,))
        result = cur.fetchall()
        data = {}
        for x in result:
            data.setdefault(x[0], {&#39;id_pokoj&#39;:x[1], &#39;data_poczatku&#39;:x[2], &#39;data_konca&#39;:x[3], &#39;data_rezerwacji&#39;:x[4], &#39;opis&#39;:x[5]})
        cur.close()
        return data

    def get_hotel_reservations(self, id_hotel):
        &#34;&#34;&#34;odczyt wszystkich rezerwacji złożonych w danym hotelu&#34;&#34;&#34;
        cur = self.conn.cursor()
        cur.execute(&#34;&#34;&#34;SELECT id_rezerwacja, id_pokoj, data_poczatku, data_konca, data_rezerwacji, opis, id_gosc, email
                FROM rezerwacje_hotelu WHERE id_hotel=%s AND r=1;&#34;&#34;&#34;, (id_hotel,))
        result = cur.fetchall()
        data = {}
        for x in result:
            data.setdefault(x[0], {&#39;id_pokoj&#39;:x[1], &#39;data_poczatku&#39;:x[2], &#39;data_konca&#39;:x[3], &#39;data_rezerwacji&#39;:x[4], &#39;opis&#39;:x[5], &#39;id_gosc&#39;:x[6], &#39;email&#39;:x[7]})
        cur.close()
        return data

    def get_filtered_hotel_reservations(self, id_hotel, email):
        &#34;&#34;&#34;odczyt wszystkich rezerwacji złożonych w danym hotelu przez gościa o danym adresie email&#34;&#34;&#34;
        cur = self.conn.cursor()
        cur.execute(&#34;&#34;&#34;SELECT id_rezerwacja, id_pokoj, data_poczatku, data_konca, data_rezerwacji, opis, id_gosc, email
                FROM rezerwacje_hotelu WHERE id_hotel=%s AND LOWER(email)=LOWER(%s) AND r=1;&#34;&#34;&#34;, (id_hotel,email))
        result = cur.fetchall()
        data = {}
        for x in result:
            data.setdefault(x[0], {&#39;id_pokoj&#39;:x[1], &#39;data_poczatku&#39;:x[2], &#39;data_konca&#39;:x[3], &#39;data_rezerwacji&#39;:x[4],&#39;opis&#39;:x[5], &#39;id_gosc&#39;:x[6], &#39;email&#39;:x[7]})
        cur.close()
        return data

    def get_rooms(self, id_hotel):
        &#34;&#34;&#34;odczyt wszystkich pokoi z danego hotelu&#34;&#34;&#34;
        cur = self.conn.cursor()
        cur.execute(&#34;&#34;&#34;SELECT numer, id_pokoj, nazwa, opis_typu, dla_palaczy, typ_wezlu_higsan, pietro, liczba_miejsc, 
            opis_pokoju, cena, okres_poczatek, okres_koniec FROM pokoje_hotelu WHERE id_hotel=%s;&#34;&#34;&#34;, (id_hotel,))
        result = cur.fetchall()
        data = {}
        for x in result:
            data.setdefault(x[0], [])
            data[x[0]].append({&#39;numer&#39;: x[0], &#39;id_pokoj&#39;:x[1], &#39;nazwa&#39;:x[2], &#39;opis_typu&#39;:x[3], &#39;dla_palaczy&#39;:x[4],
            &#39;typ_wezlu_higsan&#39;:x[5], &#39;pietro&#39;:x[6], &#39;liczba_miejsc&#39;:x[7], &#39;opis_pokoju&#39;:x[8], &#39;cena&#39;:x[9], &#39;okres_poczatek&#39;:x[10],
            &#39;okres_koniec&#39;:x[11]})
        cur.close()
        return data

    def get_chains(self):
        &#34;&#34;&#34;odczyt wszystkich sieci w bazie&#34;&#34;&#34;
        cur = self.conn.cursor()
        cur.execute(&#34;SELECT id_siec, nazwa FROM Siec;&#34;)
        result = cur.fetchall()
        data = {}
        for x in result:
            data.setdefault(x[0],{&#39;nazwa&#39;: x[1]})
        cur.close()
        return data
    
    def get_types(self, id_hotel):
        &#34;&#34;&#34;odczyt typów pokoju&#34;&#34;&#34;
        cur = self.conn.cursor()
        cur.execute(&#34;SELECT id_typ, nazwa, opis_pokoju, dla_palaczy, typ_wezlu_higsan, ilosc, opis_wyposazenia FROM typy_pokojow WHERE id_hotel=%s;&#34;, (id_hotel,))
        result = cur.fetchall()
        data = {}
        for x in result:
            data.setdefault(x[0], {&#39;id_typ&#39;: x[0], &#39;nazwa&#39; : x[1], &#39;opis_pokoju&#39; : x[2], &#39;dla_palaczy&#39; : x[3],
            &#39;typ_wezlu_higsan&#39; : x[4], &#39;wyposazenie&#39;:[]})
            data[x[0]][&#39;wyposazenie&#39;].append({&#39;ilosc&#39;: x[5], &#39;opis_wyposazenia&#39; : x[6]})
        cur.close()
        return data

    def get_room_equipments(self, id_pokoj):
        &#34;&#34;&#34;odczyt wyposażenia danego pokoju&#34;&#34;&#34;
        cur = self.conn.cursor()
        cur.execute(&#34;SELECT ilosc, opis FROM wyposazenie_pokoju WHERE id_pokoj=%s;&#34;, (id_pokoj,))
        result = cur.fetchall()
        data = []
        for x in result:
            data.append({&#39;ilosc&#39;: x[0], &#39;opis&#39; : x[1]})
        cur.close()
        return data

    def add_guest(self, data):
        &#34;&#34;&#34;rejestracja gościa w bazie&#34;&#34;&#34;
        cur = self.conn.cursor()
        try:
            cur.execute(&#34;INSERT INTO Gosc ( email, haslo, imie, nazwisko, telefon ) VALUES (%s, crypt(%s, gen_salt(&#39;bf&#39;)), %s, %s, %s);&#34;,
                    (data[&#39;email&#39;], data[&#39;haslo&#39;], data[&#39;imie&#39;], data[&#39;nazwisko&#39;], data[&#39;telefon&#39;]))
            message = (True,&#34;Pomyslnie zarejestrowano&#34;)
            self.conn.commit()
        except psycopg2.errors.RaiseException as err:
            print(err)
            message = (False, self.handle_errors(err))
        except Exception as err:
            print(err)
            message = (False, self.handle_general_errors(err))
        cur.close()
        return message

    def update_guest(self, data, id_gosc):
        &#34;&#34;&#34;edycja danych gościa o danym id_gosc&#34;&#34;&#34;
        cur = self.conn.cursor()
        try:
            if data[&#39;email&#39;]:
                cur.execute(&#34;UPDATE Gosc SET email = %s WHERE id_gosc = %s&#34;, (data[&#39;email&#39;], id_gosc))
                self.conn.commit()
            if data[&#39;haslo&#39;]:
                cur.execute(&#34;UPDATE Gosc SET haslo = crypt(%s, gen_salt(&#39;bf&#39;)) WHERE id_gosc = %s&#34;, (data[&#39;haslo&#39;], id_gosc))
                self.conn.commit()
            if data[&#39;imie&#39;]:
                cur.execute(&#34;UPDATE Gosc SET imie = %s WHERE id_gosc = %s&#34;, (data[&#39;imie&#39;], id_gosc))
                self.conn.commit()
            if data[&#39;nazwisko&#39;]:
                cur.execute(&#34;UPDATE Gosc SET nazwisko = %s WHERE id_gosc = %s&#34;, (data[&#39;nazwisko&#39;], id_gosc))
                self.conn.commit()
            if data[&#39;telefon&#39;]:
                cur.execute(&#34;UPDATE Gosc SET telefon = %s WHERE id_gosc = %s&#34;, (data[&#39;telefon&#39;], id_gosc))
                self.conn.commit()
            message = (True,&#34;Pomyslnie edytowano dane&#34;)
        except psycopg2.errors.RaiseException as err:
            print(err)
            message = (False, self.handle_errors(err))
        except Exception as err:
            print(err)
            message = (False, self.handle_general_errors(err))
        cur.close()
        return message

    def add_employee(self, data):
        &#34;&#34;&#34;rejestracja pracownika&#34;&#34;&#34;
        cur = self.conn.cursor()
        try:
            cur.execute(&#34;&#34;&#34;INSERT INTO Pracownik ( id_hotel, email, haslo, imie, nazwisko) 
                    VALUES (%s, %s, crypt(%s, gen_salt(&#39;bf&#39;)), %s, %s);&#34;&#34;&#34;, 
                    (data[&#39;id_hotel&#39;], data[&#39;email&#39;], data[&#39;haslo&#39;], data[&#39;imie&#39;], data[&#39;nazwisko&#39;]))
            message = (True,&#34;Pomyslnie dodano pracownika&#34;)
            self.conn.commit()
        except psycopg2.errors.RaiseException as err:
            print(err)
            message = (False, self.handle_errors(err))
        except Exception as err:
            print(err)
            message = (False, self.handle_general_errors(err))
        cur.close()
        return message

    def update_employee(self, data, id_pracownik):
        &#34;&#34;&#34;edycja danych pracownika o danym id_pracownik&#34;&#34;&#34;
        cur = self.conn.cursor()
        try:
            if data[&#39;email&#39;]:
                cur.execute(&#34;UPDATE Pracownik SET email = %s WHERE id_pracownik = %s&#34;, (data[&#39;email&#39;], id_pracownik))
                self.conn.commit()
            if data[&#39;haslo&#39;]:
                cur.execute(&#34;UPDATE Pracownik SET haslo = crypt(%s, gen_salt(&#39;bf&#39;)) WHERE id_pracownik = %s&#34;, (data[&#39;haslo&#39;], id_pracownik))
                self.conn.commit()
            if data[&#39;imie&#39;]:
                cur.execute(&#34;UPDATE Pracownik SET imie = %s WHERE id_pracownik = %s&#34;, (data[&#39;imie&#39;], id_pracownik))
                self.conn.commit()
            if data[&#39;nazwisko&#39;]:
                cur.execute(&#34;UPDATE Pracownik SET nazwisko = %s WHERE id_pracownik = %s&#34;, (data[&#39;nazwisko&#39;], id_pracownik))
                self.conn.commit()
            message = (True,&#34;Pomyslnie edytowano dane&#34;)
        except psycopg2.errors.RaiseException as err:
            print(err)
            message = (False, self.handle_errors(err))
        except Exception as err:
            print(err)
            message = (False, self.handle_general_errors(err))
        cur.close()
        return message

    def login_user(self, data):
        &#34;&#34;&#34;sprawdzanie poprawności logowania użytkownika&#34;&#34;&#34;
        cur = self.conn.cursor()
        cur.execute(&#34;SELECT id_gosc FROM Gosc WHERE email=%s AND haslo = crypt(%s, haslo);&#34;, (data[&#39;email&#39;], data[&#39;haslo&#39;]))
        result = cur.fetchone()
        if result:
            cur.close()
            return (True, False, result[0])
        else:
            cur.execute(&#34;SELECT id_hotel, id_pracownik FROM Pracownik WHERE email=%s AND haslo = crypt(%s, haslo);&#34;, (data[&#39;email&#39;], data[&#39;haslo&#39;]))
            result = cur.fetchone()
            if result:
                cur.close()
                return (True, True, result[0], result[1])
        cur.close()
        return (False, False)

    def logout(self):
        &#34;&#34;&#34;wylogowanie użytkownika, czyli usunięcie obecnego user_id z bazy&#34;&#34;&#34;
        cur = self.conn.cursor()
        cur.execute(&#34;SET public.user_id TO DEFAULT;&#34;)
        self.conn.commit()
        cur.close()

    def add_guest_reservation(self, data):
        &#34;&#34;&#34;dodawanie rezerwacji przez gościa&#34;&#34;&#34;
        cur = self.conn.cursor()
        cur.execute(&#34;SET public.user_id = %s&#34;, (data[&#39;id_gosc&#39;],))
        try:
            cur.execute(&#34;&#34;&#34;INSERT INTO Rezerwacja (id_pokoj, data_poczatku, data_konca, data_rezerwacji) 
                VALUES (%s, %s, %s, CURRENT_DATE);&#34;&#34;&#34;, (data[&#39;id_pokoj&#39;],data[&#39;data_poczatku&#39;], data[&#39;data_konca&#39;]))
            message = (True, &#34;Pomyslnie zlozono rezerwacje&#34;)
            self.conn.commit()
        except psycopg2.errors.RaiseException as err:
            print(err)
            message = (False, self.handle_errors(err))
        except Exception as err:
            print(err)
            message = (False, self.handle_general_errors(err))
        cur.close()
        return message

    def cancel_guest_reservation(self, data):
        &#34;&#34;&#34;anulowanie danej rezerwacji przez gościa&#34;&#34;&#34;
        cur = self.conn.cursor()
        try:
            cur.execute(&#34;SELECT * FROM anuluj_rezerwacje(%s);&#34;, (data,))
            message = (True, &#34;Pomyslnie anulowano rezerwacje&#34;)
            self.conn.commit()
        except psycopg2.errors.RaiseException as err:
            print(err)
            message = (False, self.handle_errors(err))
        except Exception as err:
            print(err)
            message = (False, self.handle_general_errors(err))
        cur.close()
        return message

    def pay_guest_reservation(self, data):
        &#34;&#34;&#34;zapłacanie za daną rezerwacje przez gościa&#34;&#34;&#34;
        cur = self.conn.cursor()
        try:
            cur.execute(&#34;INSERT INTO Status_rezerwacji (id_rezerwacja, data_zmiany_stanu, id_status) VALUES (%s, CURRENT_DATE, 2);&#34;, (data,))
            message = (True, &#34;Pomyslnie zaplacono za rezerwacje&#34;)
            self.conn.commit()
        except psycopg2.errors.RaiseException as err:
            print(err)
            message = (False, self.handle_errors(err))
        except Exception as err:
            print(err)
            message = (False, self.handle_general_errors(err))
        cur.close()
        return message

    def change_guest_reservation(self, data):
        &#34;&#34;&#34;zmiana statusu danej rezerwacji przez pracownika&#34;&#34;&#34;
        cur = self.conn.cursor()
        try:
            cur.execute(&#34;INSERT INTO Status_rezerwacji (id_rezerwacja, data_zmiany_stanu, id_status) VALUES (%s, CURRENT_DATE, %s);&#34;, 
                (data[&#39;id_rezerwacja&#39;],data[&#39;id_status&#39;]))
            message = (True, &#34;Pomyslnie zmieniono status rezerwacji&#34;)
            self.conn.commit()
        except psycopg2.errors.RaiseException as err:
            print(err)
            message = (False, self.handle_errors(err))
        except Exception as err:
            print(err)
            message = (False, self.handle_general_errors(err))
        cur.close()
        return message

    def add_chain(self, data):
        &#34;&#34;&#34;dodawanie sieci do bazy&#34;&#34;&#34;
        cur = self.conn.cursor()
        try:
            cur.execute(&#34;INSERT INTO Siec (nazwa) VALUES (%s);&#34;, (data[&#39;nazwa&#39;],))
            message = (True, &#34;Pomyslnie dodano siec&#34;)
            self.conn.commit()
        except psycopg2.errors.RaiseException as err:
            print(err)
            message = (False, self.handle_errors(err))
        except Exception as err:
            print(err)
            message = (False, self.handle_general_errors(err))
        cur.close()
        return message
    
    def add_hotel(self, data):
        &#34;&#34;&#34;dodawanie hotelu do bazy&#34;&#34;&#34;
        cur = self.conn.cursor()
        try:
            cur.execute(&#34;INSERT INTO Hotel (id_siec, nazwa, telefon, email, kategoria, adres) VALUES (%s, %s, %s, %s, %s, %s);&#34;,
                (data[&#39;id_siec&#39;], data[&#39;nazwa&#39;],data[&#39;telefon&#39;], data[&#39;email&#39;],data[&#39;kategoria&#39;], data[&#39;adres&#39;]))
            message = (True, &#34;Pomyslnie dodano hotel&#34;)
            self.conn.commit()
        except psycopg2.errors.RaiseException as err:
            print(err)
            message = (False, self.handle_errors(err))
        except Exception as err:
            print(err)
            message = (False, self.handle_general_errors(err))
        cur.close()
        return message

    def add_attraction(self, data):
        &#34;&#34;&#34;dodawanie atrakcji do bazy&#34;&#34;&#34;
        cur = self.conn.cursor()
        try:
            cur.execute(&#34;INSERT INTO Atrakcje (opis) VALUES (%s);&#34;, (data[&#39;opis&#39;],))
            message = (True, &#34;Pomyslnie dodano atrakcje&#34;)
            self.conn.commit()
        except psycopg2.errors.RaiseException as err:
            print(err)
            message = (False, self.handle_errors(err))
        except Exception as err:
            print(err)
            message = (False, self.handle_general_errors(err))
        cur.close()
        return message

    def add_equipment(self, data):
        &#34;&#34;&#34;dodawanie wyposażenia do bazy&#34;&#34;&#34;
        cur = self.conn.cursor()
        try:
            cur.execute(&#34;INSERT INTO Wyposazenie (opis) VALUES (%s);&#34;, (data[&#39;opis&#39;],))
            message = (True, &#34;Pomyslnie dodano wyposazenie&#34;)
            self.conn.commit()
        except psycopg2.errors.RaiseException as err:
            print(err)
            message = (False, self.handle_errors(err))
        except Exception as err:
            print(err)
            message = (False, self.handle_general_errors(err))
        cur.close()
        return message

    def add_equipment_to_type(self, data):
        &#34;&#34;&#34;przypisywanie wyposażenia do danego typu pokoju&#34;&#34;&#34;
        cur = self.conn.cursor()
        try:
            cur.execute(&#34;INSERT INTO typ_wyp (id_typ, id_wyposazenie, ilosc) VALUES (%s,%s,%s);&#34;,
                (data[&#39;id_typ&#39;],data[&#39;id_wyposazenie&#39;],data[&#39;ilosc&#39;]))
            message = (True, &#34;Pomyslnie dodano wyposazenie do typu&#34;)
            self.conn.commit()
        except psycopg2.errors.RaiseException as err:
            print(err)
            message = (False, self.handle_errors(err))
        except Exception as err:
            print(err)
            message = (False, self.handle_general_errors(err))
        cur.close()
        return message 

    def add_price_to_type(self, data):
        &#34;&#34;&#34;dodawanie ceny do danego typu pokoju&#34;&#34;&#34;
        cur = self.conn.cursor()
        try:
            cur.execute(&#34;INSERT INTO Cena_dzien (id_typ, cena, okres_poczatek, okres_koniec) VALUES (%s,%s,%s,%s);&#34;,
                (data[&#39;id_typ&#39;],data[&#39;cena&#39;],data[&#39;okres_poczatek&#39;],data[&#39;okres_koniec&#39;]))
            message = (True, &#34;Pomyslnie dodano cene do typu&#34;)
            self.conn.commit()
        except psycopg2.errors.RaiseException as err:
            print(err)
            message = (False, self.handle_errors(err))
        except Exception as err:
            print(err)
            message = (False, self.handle_general_errors(err))
        cur.close()
        return message 

    def add_attraction_to_hotel(self, data):
        &#34;&#34;&#34;przypisywanie atrakcji do danego hotelu&#34;&#34;&#34;
        cur = self.conn.cursor()
        try:
            cur.execute(&#34;INSERT INTO hot_atr (id_hotel, id_atrakcje, otwarcie, zamkniecie, cena_godzina) VALUES (%s,%s,%s,%s,%s);&#34;,
                (data[&#39;id_hotel&#39;],data[&#39;id_atrakcje&#39;],data[&#39;otwarcie&#39;],data[&#39;zamkniecie&#39;],data[&#39;cena_godzina&#39;]))
            message = (True, &#34;Pomyslnie dodano atrakcje do hotelu&#34;)
            self.conn.commit()
        except psycopg2.errors.RaiseException as err:
            print(err)
            message = (False, self.handle_errors(err))
        except Exception as err:
            print(err)
            message = (False, self.handle_general_errors(err))
        cur.close()
        return message 

    def add_room(self, data):
        &#34;&#34;&#34;dodawanie pokoju dla danego typu&#34;&#34;&#34;
        cur = self.conn.cursor()
        try:
            cur.execute(&#34;INSERT INTO Pokoj (id_typ, pietro, numer, liczba_miejsc, opis) VALUES (%s,%s,%s,%s,%s);&#34;, 
                (data[&#39;id_typ&#39;],data[&#39;pietro&#39;],data[&#39;numer&#39;],data[&#39;liczba_miejsc&#39;],data[&#39;opis&#39;]))
            message = (True, &#34;Pomyslnie dodano pokoj&#34;)
            self.conn.commit()
        except psycopg2.errors.RaiseException as err:
            print(err)
            message = (False, self.handle_errors(err))
        except Exception as err:
            print(err)
            message = (False, self.handle_general_errors(err))
        cur.close()
        return message

    def add_type(self, data):
        &#34;&#34;&#34;dodawanie typu pokoju dla danego hotelu&#34;&#34;&#34;
        cur = self.conn.cursor()
        try:
            cur.execute(&#34;INSERT INTO Typ_pokoju (id_hotel, nazwa, opis, dla_palaczy, typ_wezlu_higsan) VALUES (%s, %s,%s,%s,%s);&#34;, 
                (data[&#39;id_hotel&#39;], data[&#39;nazwa&#39;],data[&#39;opis&#39;],data[&#39;dla_palaczy&#39;],data[&#39;typ_wezlu_higsan&#39;]))
            message = (True, &#34;Pomyslnie dodano typ pokoju&#34;)
            self.conn.commit()
        except psycopg2.errors.RaiseException as err:
            print(err)
            message = (False, self.handle_errors(err))
        except Exception as err:
            print(err)
            message = (False, self.handle_general_errors(err))
        cur.close()
        return message

    def input_from_file(self, filename, table):
        &#34;&#34;&#34;pomocnicza funkcja wstawiająca dane z pliku json&#34;&#34;&#34;
        f = open(filename, encoding=&#34;utf-8&#34;) 
        file_input = json.load(f)
        f.close()
        cur = self.conn.cursor()
        for i in range(len(file_input)):
            key = file_input[i].keys()
            keys = &#39;, &#39;.join(key)
            vals = [&#39;%s&#39; for i in range(len(key))]
            vals = &#39;, &#39;.join(vals)
            SQL = f&#34;INSERT INTO {table} ( {keys} ) VALUES ( {vals} );&#34;
            data = tuple([value for key, value in file_input[i].items()])
            print(SQL, data)
            cur.execute(SQL, data)
            self.conn.commit()
        cur.close()</code></pre>
</details>
<h3>Methods</h3>
<dl>
<dt id="Rezerwacje.database.DataBase.add_attraction"><code class="name flex">
<span>def <span class="ident">add_attraction</span></span>(<span>self, data)</span>
</code></dt>
<dd>
<div class="desc"><p>dodawanie atrakcji do bazy</p></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def add_attraction(self, data):
    &#34;&#34;&#34;dodawanie atrakcji do bazy&#34;&#34;&#34;
    cur = self.conn.cursor()
    try:
        cur.execute(&#34;INSERT INTO Atrakcje (opis) VALUES (%s);&#34;, (data[&#39;opis&#39;],))
        message = (True, &#34;Pomyslnie dodano atrakcje&#34;)
        self.conn.commit()
    except psycopg2.errors.RaiseException as err:
        print(err)
        message = (False, self.handle_errors(err))
    except Exception as err:
        print(err)
        message = (False, self.handle_general_errors(err))
    cur.close()
    return message</code></pre>
</details>
</dd>
<dt id="Rezerwacje.database.DataBase.add_attraction_to_hotel"><code class="name flex">
<span>def <span class="ident">add_attraction_to_hotel</span></span>(<span>self, data)</span>
</code></dt>
<dd>
<div class="desc"><p>przypisywanie atrakcji do danego hotelu</p></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def add_attraction_to_hotel(self, data):
    &#34;&#34;&#34;przypisywanie atrakcji do danego hotelu&#34;&#34;&#34;
    cur = self.conn.cursor()
    try:
        cur.execute(&#34;INSERT INTO hot_atr (id_hotel, id_atrakcje, otwarcie, zamkniecie, cena_godzina) VALUES (%s,%s,%s,%s,%s);&#34;,
            (data[&#39;id_hotel&#39;],data[&#39;id_atrakcje&#39;],data[&#39;otwarcie&#39;],data[&#39;zamkniecie&#39;],data[&#39;cena_godzina&#39;]))
        message = (True, &#34;Pomyslnie dodano atrakcje do hotelu&#34;)
        self.conn.commit()
    except psycopg2.errors.RaiseException as err:
        print(err)
        message = (False, self.handle_errors(err))
    except Exception as err:
        print(err)
        message = (False, self.handle_general_errors(err))
    cur.close()
    return message </code></pre>
</details>
</dd>
<dt id="Rezerwacje.database.DataBase.add_chain"><code class="name flex">
<span>def <span class="ident">add_chain</span></span>(<span>self, data)</span>
</code></dt>
<dd>
<div class="desc"><p>dodawanie sieci do bazy</p></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def add_chain(self, data):
    &#34;&#34;&#34;dodawanie sieci do bazy&#34;&#34;&#34;
    cur = self.conn.cursor()
    try:
        cur.execute(&#34;INSERT INTO Siec (nazwa) VALUES (%s);&#34;, (data[&#39;nazwa&#39;],))
        message = (True, &#34;Pomyslnie dodano siec&#34;)
        self.conn.commit()
    except psycopg2.errors.RaiseException as err:
        print(err)
        message = (False, self.handle_errors(err))
    except Exception as err:
        print(err)
        message = (False, self.handle_general_errors(err))
    cur.close()
    return message</code></pre>
</details>
</dd>
<dt id="Rezerwacje.database.DataBase.add_employee"><code class="name flex">
<span>def <span class="ident">add_employee</span></span>(<span>self, data)</span>
</code></dt>
<dd>
<div class="desc"><p>rejestracja pracownika</p></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def add_employee(self, data):
    &#34;&#34;&#34;rejestracja pracownika&#34;&#34;&#34;
    cur = self.conn.cursor()
    try:
        cur.execute(&#34;&#34;&#34;INSERT INTO Pracownik ( id_hotel, email, haslo, imie, nazwisko) 
                VALUES (%s, %s, crypt(%s, gen_salt(&#39;bf&#39;)), %s, %s);&#34;&#34;&#34;, 
                (data[&#39;id_hotel&#39;], data[&#39;email&#39;], data[&#39;haslo&#39;], data[&#39;imie&#39;], data[&#39;nazwisko&#39;]))
        message = (True,&#34;Pomyslnie dodano pracownika&#34;)
        self.conn.commit()
    except psycopg2.errors.RaiseException as err:
        print(err)
        message = (False, self.handle_errors(err))
    except Exception as err:
        print(err)
        message = (False, self.handle_general_errors(err))
    cur.close()
    return message</code></pre>
</details>
</dd>
<dt id="Rezerwacje.database.DataBase.add_equipment"><code class="name flex">
<span>def <span class="ident">add_equipment</span></span>(<span>self, data)</span>
</code></dt>
<dd>
<div class="desc"><p>dodawanie wyposażenia do bazy</p></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def add_equipment(self, data):
    &#34;&#34;&#34;dodawanie wyposażenia do bazy&#34;&#34;&#34;
    cur = self.conn.cursor()
    try:
        cur.execute(&#34;INSERT INTO Wyposazenie (opis) VALUES (%s);&#34;, (data[&#39;opis&#39;],))
        message = (True, &#34;Pomyslnie dodano wyposazenie&#34;)
        self.conn.commit()
    except psycopg2.errors.RaiseException as err:
        print(err)
        message = (False, self.handle_errors(err))
    except Exception as err:
        print(err)
        message = (False, self.handle_general_errors(err))
    cur.close()
    return message</code></pre>
</details>
</dd>
<dt id="Rezerwacje.database.DataBase.add_equipment_to_type"><code class="name flex">
<span>def <span class="ident">add_equipment_to_type</span></span>(<span>self, data)</span>
</code></dt>
<dd>
<div class="desc"><p>przypisywanie wyposażenia do danego typu pokoju</p></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def add_equipment_to_type(self, data):
    &#34;&#34;&#34;przypisywanie wyposażenia do danego typu pokoju&#34;&#34;&#34;
    cur = self.conn.cursor()
    try:
        cur.execute(&#34;INSERT INTO typ_wyp (id_typ, id_wyposazenie, ilosc) VALUES (%s,%s,%s);&#34;,
            (data[&#39;id_typ&#39;],data[&#39;id_wyposazenie&#39;],data[&#39;ilosc&#39;]))
        message = (True, &#34;Pomyslnie dodano wyposazenie do typu&#34;)
        self.conn.commit()
    except psycopg2.errors.RaiseException as err:
        print(err)
        message = (False, self.handle_errors(err))
    except Exception as err:
        print(err)
        message = (False, self.handle_general_errors(err))
    cur.close()
    return message </code></pre>
</details>
</dd>
<dt id="Rezerwacje.database.DataBase.add_guest"><code class="name flex">
<span>def <span class="ident">add_guest</span></span>(<span>self, data)</span>
</code></dt>
<dd>
<div class="desc"><p>rejestracja gościa w bazie</p></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def add_guest(self, data):
    &#34;&#34;&#34;rejestracja gościa w bazie&#34;&#34;&#34;
    cur = self.conn.cursor()
    try:
        cur.execute(&#34;INSERT INTO Gosc ( email, haslo, imie, nazwisko, telefon ) VALUES (%s, crypt(%s, gen_salt(&#39;bf&#39;)), %s, %s, %s);&#34;,
                (data[&#39;email&#39;], data[&#39;haslo&#39;], data[&#39;imie&#39;], data[&#39;nazwisko&#39;], data[&#39;telefon&#39;]))
        message = (True,&#34;Pomyslnie zarejestrowano&#34;)
        self.conn.commit()
    except psycopg2.errors.RaiseException as err:
        print(err)
        message = (False, self.handle_errors(err))
    except Exception as err:
        print(err)
        message = (False, self.handle_general_errors(err))
    cur.close()
    return message</code></pre>
</details>
</dd>
<dt id="Rezerwacje.database.DataBase.add_guest_reservation"><code class="name flex">
<span>def <span class="ident">add_guest_reservation</span></span>(<span>self, data)</span>
</code></dt>
<dd>
<div class="desc"><p>dodawanie rezerwacji przez gościa</p></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def add_guest_reservation(self, data):
    &#34;&#34;&#34;dodawanie rezerwacji przez gościa&#34;&#34;&#34;
    cur = self.conn.cursor()
    cur.execute(&#34;SET public.user_id = %s&#34;, (data[&#39;id_gosc&#39;],))
    try:
        cur.execute(&#34;&#34;&#34;INSERT INTO Rezerwacja (id_pokoj, data_poczatku, data_konca, data_rezerwacji) 
            VALUES (%s, %s, %s, CURRENT_DATE);&#34;&#34;&#34;, (data[&#39;id_pokoj&#39;],data[&#39;data_poczatku&#39;], data[&#39;data_konca&#39;]))
        message = (True, &#34;Pomyslnie zlozono rezerwacje&#34;)
        self.conn.commit()
    except psycopg2.errors.RaiseException as err:
        print(err)
        message = (False, self.handle_errors(err))
    except Exception as err:
        print(err)
        message = (False, self.handle_general_errors(err))
    cur.close()
    return message</code></pre>
</details>
</dd>
<dt id="Rezerwacje.database.DataBase.add_hotel"><code class="name flex">
<span>def <span class="ident">add_hotel</span></span>(<span>self, data)</span>
</code></dt>
<dd>
<div class="desc"><p>dodawanie hotelu do bazy</p></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def add_hotel(self, data):
    &#34;&#34;&#34;dodawanie hotelu do bazy&#34;&#34;&#34;
    cur = self.conn.cursor()
    try:
        cur.execute(&#34;INSERT INTO Hotel (id_siec, nazwa, telefon, email, kategoria, adres) VALUES (%s, %s, %s, %s, %s, %s);&#34;,
            (data[&#39;id_siec&#39;], data[&#39;nazwa&#39;],data[&#39;telefon&#39;], data[&#39;email&#39;],data[&#39;kategoria&#39;], data[&#39;adres&#39;]))
        message = (True, &#34;Pomyslnie dodano hotel&#34;)
        self.conn.commit()
    except psycopg2.errors.RaiseException as err:
        print(err)
        message = (False, self.handle_errors(err))
    except Exception as err:
        print(err)
        message = (False, self.handle_general_errors(err))
    cur.close()
    return message</code></pre>
</details>
</dd>
<dt id="Rezerwacje.database.DataBase.add_price_to_type"><code class="name flex">
<span>def <span class="ident">add_price_to_type</span></span>(<span>self, data)</span>
</code></dt>
<dd>
<div class="desc"><p>dodawanie ceny do danego typu pokoju</p></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def add_price_to_type(self, data):
    &#34;&#34;&#34;dodawanie ceny do danego typu pokoju&#34;&#34;&#34;
    cur = self.conn.cursor()
    try:
        cur.execute(&#34;INSERT INTO Cena_dzien (id_typ, cena, okres_poczatek, okres_koniec) VALUES (%s,%s,%s,%s);&#34;,
            (data[&#39;id_typ&#39;],data[&#39;cena&#39;],data[&#39;okres_poczatek&#39;],data[&#39;okres_koniec&#39;]))
        message = (True, &#34;Pomyslnie dodano cene do typu&#34;)
        self.conn.commit()
    except psycopg2.errors.RaiseException as err:
        print(err)
        message = (False, self.handle_errors(err))
    except Exception as err:
        print(err)
        message = (False, self.handle_general_errors(err))
    cur.close()
    return message </code></pre>
</details>
</dd>
<dt id="Rezerwacje.database.DataBase.add_room"><code class="name flex">
<span>def <span class="ident">add_room</span></span>(<span>self, data)</span>
</code></dt>
<dd>
<div class="desc"><p>dodawanie pokoju dla danego typu</p></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def add_room(self, data):
    &#34;&#34;&#34;dodawanie pokoju dla danego typu&#34;&#34;&#34;
    cur = self.conn.cursor()
    try:
        cur.execute(&#34;INSERT INTO Pokoj (id_typ, pietro, numer, liczba_miejsc, opis) VALUES (%s,%s,%s,%s,%s);&#34;, 
            (data[&#39;id_typ&#39;],data[&#39;pietro&#39;],data[&#39;numer&#39;],data[&#39;liczba_miejsc&#39;],data[&#39;opis&#39;]))
        message = (True, &#34;Pomyslnie dodano pokoj&#34;)
        self.conn.commit()
    except psycopg2.errors.RaiseException as err:
        print(err)
        message = (False, self.handle_errors(err))
    except Exception as err:
        print(err)
        message = (False, self.handle_general_errors(err))
    cur.close()
    return message</code></pre>
</details>
</dd>
<dt id="Rezerwacje.database.DataBase.add_type"><code class="name flex">
<span>def <span class="ident">add_type</span></span>(<span>self, data)</span>
</code></dt>
<dd>
<div class="desc"><p>dodawanie typu pokoju dla danego hotelu</p></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def add_type(self, data):
    &#34;&#34;&#34;dodawanie typu pokoju dla danego hotelu&#34;&#34;&#34;
    cur = self.conn.cursor()
    try:
        cur.execute(&#34;INSERT INTO Typ_pokoju (id_hotel, nazwa, opis, dla_palaczy, typ_wezlu_higsan) VALUES (%s, %s,%s,%s,%s);&#34;, 
            (data[&#39;id_hotel&#39;], data[&#39;nazwa&#39;],data[&#39;opis&#39;],data[&#39;dla_palaczy&#39;],data[&#39;typ_wezlu_higsan&#39;]))
        message = (True, &#34;Pomyslnie dodano typ pokoju&#34;)
        self.conn.commit()
    except psycopg2.errors.RaiseException as err:
        print(err)
        message = (False, self.handle_errors(err))
    except Exception as err:
        print(err)
        message = (False, self.handle_general_errors(err))
    cur.close()
    return message</code></pre>
</details>
</dd>
<dt id="Rezerwacje.database.DataBase.cancel_guest_reservation"><code class="name flex">
<span>def <span class="ident">cancel_guest_reservation</span></span>(<span>self, data)</span>
</code></dt>
<dd>
<div class="desc"><p>anulowanie danej rezerwacji przez gościa</p></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def cancel_guest_reservation(self, data):
    &#34;&#34;&#34;anulowanie danej rezerwacji przez gościa&#34;&#34;&#34;
    cur = self.conn.cursor()
    try:
        cur.execute(&#34;SELECT * FROM anuluj_rezerwacje(%s);&#34;, (data,))
        message = (True, &#34;Pomyslnie anulowano rezerwacje&#34;)
        self.conn.commit()
    except psycopg2.errors.RaiseException as err:
        print(err)
        message = (False, self.handle_errors(err))
    except Exception as err:
        print(err)
        message = (False, self.handle_general_errors(err))
    cur.close()
    return message</code></pre>
</details>
</dd>
<dt id="Rezerwacje.database.DataBase.change_guest_reservation"><code class="name flex">
<span>def <span class="ident">change_guest_reservation</span></span>(<span>self, data)</span>
</code></dt>
<dd>
<div class="desc"><p>zmiana statusu danej rezerwacji przez pracownika</p></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def change_guest_reservation(self, data):
    &#34;&#34;&#34;zmiana statusu danej rezerwacji przez pracownika&#34;&#34;&#34;
    cur = self.conn.cursor()
    try:
        cur.execute(&#34;INSERT INTO Status_rezerwacji (id_rezerwacja, data_zmiany_stanu, id_status) VALUES (%s, CURRENT_DATE, %s);&#34;, 
            (data[&#39;id_rezerwacja&#39;],data[&#39;id_status&#39;]))
        message = (True, &#34;Pomyslnie zmieniono status rezerwacji&#34;)
        self.conn.commit()
    except psycopg2.errors.RaiseException as err:
        print(err)
        message = (False, self.handle_errors(err))
    except Exception as err:
        print(err)
        message = (False, self.handle_general_errors(err))
    cur.close()
    return message</code></pre>
</details>
</dd>
<dt id="Rezerwacje.database.DataBase.close_database"><code class="name flex">
<span>def <span class="ident">close_database</span></span>(<span>self)</span>
</code></dt>
<dd>
<div class="desc"><p>zamknięcie połączenia z bazą</p></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def close_database(self):
    &#34;&#34;&#34;zamknięcie połączenia z bazą&#34;&#34;&#34;
    self.conn.close()</code></pre>
</details>
</dd>
<dt id="Rezerwacje.database.DataBase.get_attractions"><code class="name flex">
<span>def <span class="ident">get_attractions</span></span>(<span>self)</span>
</code></dt>
<dd>
<div class="desc"><p>odczyt wszystkich możliwych atrakcji z bazy danych</p></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def get_attractions(self):
    &#34;&#34;&#34;odczyt wszystkich możliwych atrakcji z bazy danych&#34;&#34;&#34;
    cur = self.conn.cursor()
    cur.execute(&#34;SELECT id_atrakcje, opis FROM Atrakcje;&#34;)
    result = cur.fetchall()
    data = [(x[0], x[1]) for x in result]
    cur.close()
    return data</code></pre>
</details>
</dd>
<dt id="Rezerwacje.database.DataBase.get_calculated_price"><code class="name flex">
<span>def <span class="ident">get_calculated_price</span></span>(<span>self, data)</span>
</code></dt>
<dd>
<div class="desc"><p>odczyt wyliczonej przez bazę kwoty za dany pobyt</p></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def get_calculated_price(self, data):
    &#34;&#34;&#34;odczyt wyliczonej przez bazę kwoty za dany pobyt&#34;&#34;&#34;
    cur = self.conn.cursor()
    cur.execute(&#34;SELECT * FROM wylicz_cene(%s, %s, %s);&#34;, (data[&#39;data_poczatku&#39;], data[&#39;data_konca&#39;], data[&#39;id_pokoj&#39;]))
    result = cur.fetchone()[0]
    cur.close()
    return result</code></pre>
</details>
</dd>
<dt id="Rezerwacje.database.DataBase.get_chains"><code class="name flex">
<span>def <span class="ident">get_chains</span></span>(<span>self)</span>
</code></dt>
<dd>
<div class="desc"><p>odczyt wszystkich sieci w bazie</p></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def get_chains(self):
    &#34;&#34;&#34;odczyt wszystkich sieci w bazie&#34;&#34;&#34;
    cur = self.conn.cursor()
    cur.execute(&#34;SELECT id_siec, nazwa FROM Siec;&#34;)
    result = cur.fetchall()
    data = {}
    for x in result:
        data.setdefault(x[0],{&#39;nazwa&#39;: x[1]})
    cur.close()
    return data</code></pre>
</details>
</dd>
<dt id="Rezerwacje.database.DataBase.get_employee"><code class="name flex">
<span>def <span class="ident">get_employee</span></span>(<span>self, id_pracownik)</span>
</code></dt>
<dd>
<div class="desc"><p>odczyt informacji o danym pracowniku</p></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def get_employee(self, id_pracownik):
    &#34;&#34;&#34;odczyt informacji o danym pracowniku&#34;&#34;&#34;
    cur = self.conn.cursor()
    cur.execute(&#34;SELECT email, imie, nazwisko FROM Pracownik WHERE id_pracownik=%s;&#34;, (id_pracownik,))
    result = cur.fetchone()
    data = {&#39;email&#39;:result[0], 
            &#39;imie&#39;:result[1],
            &#39;nazwisko&#39;:result[2]}
    cur.close()
    return data</code></pre>
</details>
</dd>
<dt id="Rezerwacje.database.DataBase.get_equipments"><code class="name flex">
<span>def <span class="ident">get_equipments</span></span>(<span>self)</span>
</code></dt>
<dd>
<div class="desc"><p>odczyt wszystkich możliwych wyposażeń pokoju z bazy danych</p></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def get_equipments(self):
    &#34;&#34;&#34;odczyt wszystkich możliwych wyposażeń pokoju z bazy danych&#34;&#34;&#34;
    cur = self.conn.cursor()
    cur.execute(&#34;SELECT id_wyposazenie, opis FROM Wyposazenie;&#34;)
    result = cur.fetchall()
    data = [(x[0], x[1]) for x in result]
    cur.close()
    return data</code></pre>
</details>
</dd>
<dt id="Rezerwacje.database.DataBase.get_filtered_hotel_reservations"><code class="name flex">
<span>def <span class="ident">get_filtered_hotel_reservations</span></span>(<span>self, id_hotel, email)</span>
</code></dt>
<dd>
<div class="desc"><p>odczyt wszystkich rezerwacji złożonych w danym hotelu przez gościa o danym adresie email</p></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def get_filtered_hotel_reservations(self, id_hotel, email):
    &#34;&#34;&#34;odczyt wszystkich rezerwacji złożonych w danym hotelu przez gościa o danym adresie email&#34;&#34;&#34;
    cur = self.conn.cursor()
    cur.execute(&#34;&#34;&#34;SELECT id_rezerwacja, id_pokoj, data_poczatku, data_konca, data_rezerwacji, opis, id_gosc, email
            FROM rezerwacje_hotelu WHERE id_hotel=%s AND LOWER(email)=LOWER(%s) AND r=1;&#34;&#34;&#34;, (id_hotel,email))
    result = cur.fetchall()
    data = {}
    for x in result:
        data.setdefault(x[0], {&#39;id_pokoj&#39;:x[1], &#39;data_poczatku&#39;:x[2], &#39;data_konca&#39;:x[3], &#39;data_rezerwacji&#39;:x[4],&#39;opis&#39;:x[5], &#39;id_gosc&#39;:x[6], &#39;email&#39;:x[7]})
    cur.close()
    return data</code></pre>
</details>
</dd>
<dt id="Rezerwacje.database.DataBase.get_filtered_hotels"><code class="name flex">
<span>def <span class="ident">get_filtered_hotels</span></span>(<span>self, args)</span>
</code></dt>
<dd>
<div class="desc"><p>odczyt wszystkich hoteli wraz z ich sieciami z bazy danych przefiltrowane przez dostępność atrakcji</p></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def get_filtered_hotels(self, args):
    &#34;&#34;&#34;odczyt wszystkich hoteli wraz z ich sieciami z bazy danych przefiltrowane przez dostępność atrakcji&#34;&#34;&#34;
    cur = self.conn.cursor()
    cur.execute(&#34;SELECT nazwa_sieci, id_hotel, nazwa, adres, email, telefon, kategoria FROM filtruj_atrakcje %s;&#34;, (args,))
    result = cur.fetchall()
    data = {}
    for x in result:
        data.setdefault(x[0], [])
        data[x[0]].append({&#39;id_hotel&#39;: x[1], &#39;nazwa&#39;:x[2], &#39;adres&#39;:x[3], &#39;email&#39;:x[4], &#39;telefon&#39;:x[5], &#39;kategoria&#39;: x[6]})
    self.conn.commit()
    cur.close()
    return data</code></pre>
</details>
</dd>
<dt id="Rezerwacje.database.DataBase.get_filtered_rooms"><code class="name flex">
<span>def <span class="ident">get_filtered_rooms</span></span>(<span>self, data)</span>
</code></dt>
<dd>
<div class="desc"><p>odczyt wszystkich pokoji z danego hotelu przefiltrowane przez dostępność pokoi</p></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def get_filtered_rooms(self, data):
    &#34;&#34;&#34;odczyt wszystkich pokoji z danego hotelu przefiltrowane przez dostępność pokoi&#34;&#34;&#34;
    cur = self.conn.cursor()
    cur.execute(&#34;&#34;&#34;SELECT numer, id_pokoj, nazwa, opis_typu, dla_palaczy, typ_wezlu_higsan, pietro, liczba_miejsc, 
        opis_pokoju, cena, okres_poczatek, okres_koniec FROM filtruj_pokoje(%s,%s,%s);&#34;&#34;&#34;, (data[&#39;data_start&#39;],data[&#39;data_end&#39;], data[&#39;id_hotel&#39;]))
    result = cur.fetchall()
    data = {}
    for x in result:
        data.setdefault(x[0], [])
        data[x[0]].append({&#39;numer&#39;: x[0], &#39;id_pokoj&#39;:x[1], &#39;nazwa&#39;:x[2], &#39;opis_typu&#39;:x[3], &#39;dla_palaczy&#39;:x[4],
        &#39;typ_wezlu_higsan&#39;:x[5], &#39;pietro&#39;:x[6], &#39;liczba_miejsc&#39;:x[7], &#39;opis_pokoju&#39;:x[8], &#39;cena&#39;:x[9], &#39;okres_poczatek&#39;:x[10],
        &#39;okres_koniec&#39;:x[11]})
    cur.close()
    return data</code></pre>
</details>
</dd>
<dt id="Rezerwacje.database.DataBase.get_guest"><code class="name flex">
<span>def <span class="ident">get_guest</span></span>(<span>self, id_gosc)</span>
</code></dt>
<dd>
<div class="desc"><p>odczyt informacji o danym gościu</p></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def get_guest(self, id_gosc):
    &#34;&#34;&#34;odczyt informacji o danym gościu&#34;&#34;&#34;
    cur = self.conn.cursor()
    cur.execute(&#34;SELECT email, imie, nazwisko, telefon FROM Gosc WHERE id_gosc=%s;&#34;, (id_gosc,))
    result = cur.fetchone()
    data = {&#39;email&#39;:result[0], 
            &#39;imie&#39;:result[1],
            &#39;nazwisko&#39;:result[2], 
            &#39;telefon&#39;:result[3]}
    cur.close()
    return data</code></pre>
</details>
</dd>
<dt id="Rezerwacje.database.DataBase.get_guest_reservations"><code class="name flex">
<span>def <span class="ident">get_guest_reservations</span></span>(<span>self, id_gosc)</span>
</code></dt>
<dd>
<div class="desc"><p>odczyt wszystkich rezerwacji złożonych przez danego gościa</p></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def get_guest_reservations(self, id_gosc):
    &#34;&#34;&#34;odczyt wszystkich rezerwacji złożonych przez danego gościa&#34;&#34;&#34;
    cur = self.conn.cursor()
    cur.execute(&#34;&#34;&#34;SELECT id_rezerwacja, id_pokoj, data_poczatku, data_konca, data_rezerwacji, opis 
            FROM rezerwacje_goscia WHERE id_gosc=%s AND r=1;&#34;&#34;&#34;, (id_gosc,))
    result = cur.fetchall()
    data = {}
    for x in result:
        data.setdefault(x[0], {&#39;id_pokoj&#39;:x[1], &#39;data_poczatku&#39;:x[2], &#39;data_konca&#39;:x[3], &#39;data_rezerwacji&#39;:x[4], &#39;opis&#39;:x[5]})
    cur.close()
    return data</code></pre>
</details>
</dd>
<dt id="Rezerwacje.database.DataBase.get_hotel_attractions"><code class="name flex">
<span>def <span class="ident">get_hotel_attractions</span></span>(<span>self, id_hotel)</span>
</code></dt>
<dd>
<div class="desc"><p>odczyt atrakcji danego hotelu</p></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def get_hotel_attractions(self, id_hotel):
    &#34;&#34;&#34;odczyt atrakcji danego hotelu&#34;&#34;&#34;
    cur = self.conn.cursor()
    cur.execute(&#34;SELECT opis, otwarcie, zamkniecie, cena_godzina FROM atrakcje_hotelu WHERE id_hotel=%s;&#34;, (id_hotel,))
    result = cur.fetchall()
    data = [(x[0], x[1], x[2], x[3]) for x in result]
    cur.close()
    return data</code></pre>
</details>
</dd>
<dt id="Rezerwacje.database.DataBase.get_hotel_reservations"><code class="name flex">
<span>def <span class="ident">get_hotel_reservations</span></span>(<span>self, id_hotel)</span>
</code></dt>
<dd>
<div class="desc"><p>odczyt wszystkich rezerwacji złożonych w danym hotelu</p></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def get_hotel_reservations(self, id_hotel):
    &#34;&#34;&#34;odczyt wszystkich rezerwacji złożonych w danym hotelu&#34;&#34;&#34;
    cur = self.conn.cursor()
    cur.execute(&#34;&#34;&#34;SELECT id_rezerwacja, id_pokoj, data_poczatku, data_konca, data_rezerwacji, opis, id_gosc, email
            FROM rezerwacje_hotelu WHERE id_hotel=%s AND r=1;&#34;&#34;&#34;, (id_hotel,))
    result = cur.fetchall()
    data = {}
    for x in result:
        data.setdefault(x[0], {&#39;id_pokoj&#39;:x[1], &#39;data_poczatku&#39;:x[2], &#39;data_konca&#39;:x[3], &#39;data_rezerwacji&#39;:x[4], &#39;opis&#39;:x[5], &#39;id_gosc&#39;:x[6], &#39;email&#39;:x[7]})
    cur.close()
    return data</code></pre>
</details>
</dd>
<dt id="Rezerwacje.database.DataBase.get_hotel_statistics"><code class="name flex">
<span>def <span class="ident">get_hotel_statistics</span></span>(<span>self, id_hotel)</span>
</code></dt>
<dd>
<div class="desc"><p>odczyt statystyk dla hotelu z danym id_hotel</p></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def get_hotel_statistics(self, id_hotel):
    &#34;&#34;&#34;odczyt statystyk dla hotelu z danym id_hotel&#34;&#34;&#34;
    cur = self.conn.cursor()
    data = {}

    cur.execute(&#34;SELECT min_cena, max_cena FROM min_max_cena_na_hotel WHERE id_hotel=%s;&#34;, (id_hotel,))
    result = cur.fetchone()
    data.setdefault(&#34;min_cena&#34;, result[0])
    data.setdefault(&#34;max_cena&#34;, result[1])

    cur.execute(&#34;SELECT l_pokoi FROM liczba_pokoi_na_hotel WHERE id_hotel=%s;&#34;, (id_hotel,))
    result = cur.fetchone()
    data.setdefault(&#34;liczba_pokoi&#34;, result[0])

    cur.close()
    return data</code></pre>
</details>
</dd>
<dt id="Rezerwacje.database.DataBase.get_hotels"><code class="name flex">
<span>def <span class="ident">get_hotels</span></span>(<span>self)</span>
</code></dt>
<dd>
<div class="desc"><p>odczyt wszystkich hoteli wraz z ich sieciami z bazy danych</p></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def get_hotels(self):
    &#34;&#34;&#34;odczyt wszystkich hoteli wraz z ich sieciami z bazy danych&#34;&#34;&#34;
    cur = self.conn.cursor()
    cur.execute(&#34;SELECT nazwa_sieci, id_hotel, nazwa, adres, email, telefon, kategoria FROM hotele_sieci;&#34;)
    result = cur.fetchall()
    data = {}
    for x in result:
        data.setdefault(x[0], [])
        data[x[0]].append({&#39;id_hotel&#39;: x[1], &#39;nazwa&#39;:x[2], &#39;adres&#39;:x[3], &#39;email&#39;:x[4], &#39;telefon&#39;:x[5], &#39;kategoria&#39;: x[6]})
    cur.close()
    return data</code></pre>
</details>
</dd>
<dt id="Rezerwacje.database.DataBase.get_room_availability"><code class="name flex">
<span>def <span class="ident">get_room_availability</span></span>(<span>self, id_pokoj)</span>
</code></dt>
<dd>
<div class="desc"><p>odczyt wolnych terminów pokoju</p></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def get_room_availability(self, id_pokoj):
    &#34;&#34;&#34;odczyt wolnych terminów pokoju&#34;&#34;&#34;
    cur = self.conn.cursor()
    cur.execute(&#34;SELECT data_poczatku, data_konca FROM terminy_pokoju WHERE id_pokoj=%s;&#34;, (id_pokoj,))
    result = cur.fetchall()
    data = []
    for x in result:
        data.append({&#39;data_poczatku&#39;: x[0], &#39;data_konca&#39;:x[1]})
    cur.close()
    return data</code></pre>
</details>
</dd>
<dt id="Rezerwacje.database.DataBase.get_room_equipments"><code class="name flex">
<span>def <span class="ident">get_room_equipments</span></span>(<span>self, id_pokoj)</span>
</code></dt>
<dd>
<div class="desc"><p>odczyt wyposażenia danego pokoju</p></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def get_room_equipments(self, id_pokoj):
    &#34;&#34;&#34;odczyt wyposażenia danego pokoju&#34;&#34;&#34;
    cur = self.conn.cursor()
    cur.execute(&#34;SELECT ilosc, opis FROM wyposazenie_pokoju WHERE id_pokoj=%s;&#34;, (id_pokoj,))
    result = cur.fetchall()
    data = []
    for x in result:
        data.append({&#39;ilosc&#39;: x[0], &#39;opis&#39; : x[1]})
    cur.close()
    return data</code></pre>
</details>
</dd>
<dt id="Rezerwacje.database.DataBase.get_rooms"><code class="name flex">
<span>def <span class="ident">get_rooms</span></span>(<span>self, id_hotel)</span>
</code></dt>
<dd>
<div class="desc"><p>odczyt wszystkich pokoi z danego hotelu</p></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def get_rooms(self, id_hotel):
    &#34;&#34;&#34;odczyt wszystkich pokoi z danego hotelu&#34;&#34;&#34;
    cur = self.conn.cursor()
    cur.execute(&#34;&#34;&#34;SELECT numer, id_pokoj, nazwa, opis_typu, dla_palaczy, typ_wezlu_higsan, pietro, liczba_miejsc, 
        opis_pokoju, cena, okres_poczatek, okres_koniec FROM pokoje_hotelu WHERE id_hotel=%s;&#34;&#34;&#34;, (id_hotel,))
    result = cur.fetchall()
    data = {}
    for x in result:
        data.setdefault(x[0], [])
        data[x[0]].append({&#39;numer&#39;: x[0], &#39;id_pokoj&#39;:x[1], &#39;nazwa&#39;:x[2], &#39;opis_typu&#39;:x[3], &#39;dla_palaczy&#39;:x[4],
        &#39;typ_wezlu_higsan&#39;:x[5], &#39;pietro&#39;:x[6], &#39;liczba_miejsc&#39;:x[7], &#39;opis_pokoju&#39;:x[8], &#39;cena&#39;:x[9], &#39;okres_poczatek&#39;:x[10],
        &#39;okres_koniec&#39;:x[11]})
    cur.close()
    return data</code></pre>
</details>
</dd>
<dt id="Rezerwacje.database.DataBase.get_statistics"><code class="name flex">
<span>def <span class="ident">get_statistics</span></span>(<span>self)</span>
</code></dt>
<dd>
<div class="desc"><p>odczyt ogólnych statystyk hoteli w bazie</p></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def get_statistics(self):
    &#34;&#34;&#34;odczyt ogólnych statystyk hoteli w bazie&#34;&#34;&#34;
    cur = self.conn.cursor()
    data = {}

    cur.execute(&#34;SELECT min_cena, max_cena FROM min_max_cena;&#34;)
    result = cur.fetchone()
    data.setdefault(&#34;min_cena&#34;, result[0])
    data.setdefault(&#34;max_cena&#34;, result[1])

    cur.execute(&#34;SELECT l_hoteli FROM liczba_hoteli;&#34;)
    result = cur.fetchone()
    data.setdefault(&#34;liczba_hoteli&#34;, result[0])

    cur.execute(&#34;SELECT l_pokoi FROM liczba_pokoi;&#34;)
    result = cur.fetchone()
    data.setdefault(&#34;liczba_pokoi&#34;, result[0])

    cur.close()
    return data</code></pre>
</details>
</dd>
<dt id="Rezerwacje.database.DataBase.get_status"><code class="name flex">
<span>def <span class="ident">get_status</span></span>(<span>self)</span>
</code></dt>
<dd>
<div class="desc"><p>odczyt wszystkich możliwych statusów rezerwacji z bazy danych</p></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def get_status(self):
    &#34;&#34;&#34;odczyt wszystkich możliwych statusów rezerwacji z bazy danych&#34;&#34;&#34;
    cur = self.conn.cursor()
    cur.execute(&#34;SELECT id_status, opis FROM Status;&#34;)
    result = cur.fetchall()
    data = [(x[0], x[1]) for x in result]
    cur.close()
    return data</code></pre>
</details>
</dd>
<dt id="Rezerwacje.database.DataBase.get_types"><code class="name flex">
<span>def <span class="ident">get_types</span></span>(<span>self, id_hotel)</span>
</code></dt>
<dd>
<div class="desc"><p>odczyt typów pokoju</p></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def get_types(self, id_hotel):
    &#34;&#34;&#34;odczyt typów pokoju&#34;&#34;&#34;
    cur = self.conn.cursor()
    cur.execute(&#34;SELECT id_typ, nazwa, opis_pokoju, dla_palaczy, typ_wezlu_higsan, ilosc, opis_wyposazenia FROM typy_pokojow WHERE id_hotel=%s;&#34;, (id_hotel,))
    result = cur.fetchall()
    data = {}
    for x in result:
        data.setdefault(x[0], {&#39;id_typ&#39;: x[0], &#39;nazwa&#39; : x[1], &#39;opis_pokoju&#39; : x[2], &#39;dla_palaczy&#39; : x[3],
        &#39;typ_wezlu_higsan&#39; : x[4], &#39;wyposazenie&#39;:[]})
        data[x[0]][&#39;wyposazenie&#39;].append({&#39;ilosc&#39;: x[5], &#39;opis_wyposazenia&#39; : x[6]})
    cur.close()
    return data</code></pre>
</details>
</dd>
<dt id="Rezerwacje.database.DataBase.handle_errors"><code class="name flex">
<span>def <span class="ident">handle_errors</span></span>(<span>self, err)</span>
</code></dt>
<dd>
<div class="desc"><p>cofnięcie operacji w przypadku błędu z triggera i przyjaźniejsze dla użytkownika wyświetlanie komunikatu</p></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def handle_errors(self, err):
    &#34;&#34;&#34;cofnięcie operacji w przypadku błędu z triggera i przyjaźniejsze dla użytkownika wyświetlanie komunikatu&#34;&#34;&#34;
    errormessage = str(err.pgerror).split(&#34;CONTEXT&#34;)
    self.conn.rollback()
    return errormessage[0]</code></pre>
</details>
</dd>
<dt id="Rezerwacje.database.DataBase.handle_general_errors"><code class="name flex">
<span>def <span class="ident">handle_general_errors</span></span>(<span>self, err)</span>
</code></dt>
<dd>
<div class="desc"><p>cofnięcie operacji w przypadku błędu i przyjaźniejsze dla użytkownika wyświetlanie komunikatu</p></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def handle_general_errors(self, err):
    &#34;&#34;&#34;cofnięcie operacji w przypadku błędu i przyjaźniejsze dla użytkownika wyświetlanie komunikatu&#34;&#34;&#34;
    errormessage = str(err.pgerror).split(&#34;LINE&#34;)
    self.conn.rollback()
    return errormessage[0]</code></pre>
</details>
</dd>
<dt id="Rezerwacje.database.DataBase.input_from_file"><code class="name flex">
<span>def <span class="ident">input_from_file</span></span>(<span>self, filename, table)</span>
</code></dt>
<dd>
<div class="desc"><p>pomocnicza funkcja wstawiająca dane z pliku json</p></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def input_from_file(self, filename, table):
    &#34;&#34;&#34;pomocnicza funkcja wstawiająca dane z pliku json&#34;&#34;&#34;
    f = open(filename, encoding=&#34;utf-8&#34;) 
    file_input = json.load(f)
    f.close()
    cur = self.conn.cursor()
    for i in range(len(file_input)):
        key = file_input[i].keys()
        keys = &#39;, &#39;.join(key)
        vals = [&#39;%s&#39; for i in range(len(key))]
        vals = &#39;, &#39;.join(vals)
        SQL = f&#34;INSERT INTO {table} ( {keys} ) VALUES ( {vals} );&#34;
        data = tuple([value for key, value in file_input[i].items()])
        print(SQL, data)
        cur.execute(SQL, data)
        self.conn.commit()
    cur.close()</code></pre>
</details>
</dd>
<dt id="Rezerwacje.database.DataBase.login_user"><code class="name flex">
<span>def <span class="ident">login_user</span></span>(<span>self, data)</span>
</code></dt>
<dd>
<div class="desc"><p>sprawdzanie poprawności logowania użytkownika</p></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def login_user(self, data):
    &#34;&#34;&#34;sprawdzanie poprawności logowania użytkownika&#34;&#34;&#34;
    cur = self.conn.cursor()
    cur.execute(&#34;SELECT id_gosc FROM Gosc WHERE email=%s AND haslo = crypt(%s, haslo);&#34;, (data[&#39;email&#39;], data[&#39;haslo&#39;]))
    result = cur.fetchone()
    if result:
        cur.close()
        return (True, False, result[0])
    else:
        cur.execute(&#34;SELECT id_hotel, id_pracownik FROM Pracownik WHERE email=%s AND haslo = crypt(%s, haslo);&#34;, (data[&#39;email&#39;], data[&#39;haslo&#39;]))
        result = cur.fetchone()
        if result:
            cur.close()
            return (True, True, result[0], result[1])
    cur.close()
    return (False, False)</code></pre>
</details>
</dd>
<dt id="Rezerwacje.database.DataBase.logout"><code class="name flex">
<span>def <span class="ident">logout</span></span>(<span>self)</span>
</code></dt>
<dd>
<div class="desc"><p>wylogowanie użytkownika, czyli usunięcie obecnego user_id z bazy</p></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def logout(self):
    &#34;&#34;&#34;wylogowanie użytkownika, czyli usunięcie obecnego user_id z bazy&#34;&#34;&#34;
    cur = self.conn.cursor()
    cur.execute(&#34;SET public.user_id TO DEFAULT;&#34;)
    self.conn.commit()
    cur.close()</code></pre>
</details>
</dd>
<dt id="Rezerwacje.database.DataBase.pay_guest_reservation"><code class="name flex">
<span>def <span class="ident">pay_guest_reservation</span></span>(<span>self, data)</span>
</code></dt>
<dd>
<div class="desc"><p>zapłacanie za daną rezerwacje przez gościa</p></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def pay_guest_reservation(self, data):
    &#34;&#34;&#34;zapłacanie za daną rezerwacje przez gościa&#34;&#34;&#34;
    cur = self.conn.cursor()
    try:
        cur.execute(&#34;INSERT INTO Status_rezerwacji (id_rezerwacja, data_zmiany_stanu, id_status) VALUES (%s, CURRENT_DATE, 2);&#34;, (data,))
        message = (True, &#34;Pomyslnie zaplacono za rezerwacje&#34;)
        self.conn.commit()
    except psycopg2.errors.RaiseException as err:
        print(err)
        message = (False, self.handle_errors(err))
    except Exception as err:
        print(err)
        message = (False, self.handle_general_errors(err))
    cur.close()
    return message</code></pre>
</details>
</dd>
<dt id="Rezerwacje.database.DataBase.update_employee"><code class="name flex">
<span>def <span class="ident">update_employee</span></span>(<span>self, data, id_pracownik)</span>
</code></dt>
<dd>
<div class="desc"><p>edycja danych pracownika o danym id_pracownik</p></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def update_employee(self, data, id_pracownik):
    &#34;&#34;&#34;edycja danych pracownika o danym id_pracownik&#34;&#34;&#34;
    cur = self.conn.cursor()
    try:
        if data[&#39;email&#39;]:
            cur.execute(&#34;UPDATE Pracownik SET email = %s WHERE id_pracownik = %s&#34;, (data[&#39;email&#39;], id_pracownik))
            self.conn.commit()
        if data[&#39;haslo&#39;]:
            cur.execute(&#34;UPDATE Pracownik SET haslo = crypt(%s, gen_salt(&#39;bf&#39;)) WHERE id_pracownik = %s&#34;, (data[&#39;haslo&#39;], id_pracownik))
            self.conn.commit()
        if data[&#39;imie&#39;]:
            cur.execute(&#34;UPDATE Pracownik SET imie = %s WHERE id_pracownik = %s&#34;, (data[&#39;imie&#39;], id_pracownik))
            self.conn.commit()
        if data[&#39;nazwisko&#39;]:
            cur.execute(&#34;UPDATE Pracownik SET nazwisko = %s WHERE id_pracownik = %s&#34;, (data[&#39;nazwisko&#39;], id_pracownik))
            self.conn.commit()
        message = (True,&#34;Pomyslnie edytowano dane&#34;)
    except psycopg2.errors.RaiseException as err:
        print(err)
        message = (False, self.handle_errors(err))
    except Exception as err:
        print(err)
        message = (False, self.handle_general_errors(err))
    cur.close()
    return message</code></pre>
</details>
</dd>
<dt id="Rezerwacje.database.DataBase.update_guest"><code class="name flex">
<span>def <span class="ident">update_guest</span></span>(<span>self, data, id_gosc)</span>
</code></dt>
<dd>
<div class="desc"><p>edycja danych gościa o danym id_gosc</p></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def update_guest(self, data, id_gosc):
    &#34;&#34;&#34;edycja danych gościa o danym id_gosc&#34;&#34;&#34;
    cur = self.conn.cursor()
    try:
        if data[&#39;email&#39;]:
            cur.execute(&#34;UPDATE Gosc SET email = %s WHERE id_gosc = %s&#34;, (data[&#39;email&#39;], id_gosc))
            self.conn.commit()
        if data[&#39;haslo&#39;]:
            cur.execute(&#34;UPDATE Gosc SET haslo = crypt(%s, gen_salt(&#39;bf&#39;)) WHERE id_gosc = %s&#34;, (data[&#39;haslo&#39;], id_gosc))
            self.conn.commit()
        if data[&#39;imie&#39;]:
            cur.execute(&#34;UPDATE Gosc SET imie = %s WHERE id_gosc = %s&#34;, (data[&#39;imie&#39;], id_gosc))
            self.conn.commit()
        if data[&#39;nazwisko&#39;]:
            cur.execute(&#34;UPDATE Gosc SET nazwisko = %s WHERE id_gosc = %s&#34;, (data[&#39;nazwisko&#39;], id_gosc))
            self.conn.commit()
        if data[&#39;telefon&#39;]:
            cur.execute(&#34;UPDATE Gosc SET telefon = %s WHERE id_gosc = %s&#34;, (data[&#39;telefon&#39;], id_gosc))
            self.conn.commit()
        message = (True,&#34;Pomyslnie edytowano dane&#34;)
    except psycopg2.errors.RaiseException as err:
        print(err)
        message = (False, self.handle_errors(err))
    except Exception as err:
        print(err)
        message = (False, self.handle_general_errors(err))
    cur.close()
    return message</code></pre>
</details>
</dd>
<dt id="Rezerwacje.database.DataBase.update_reservations"><code class="name flex">
<span>def <span class="ident">update_reservations</span></span>(<span>self)</span>
</code></dt>
<dd>
<div class="desc"><p>aktualizacja rezerwacji</p></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def update_reservations(self):
    &#34;&#34;&#34;aktualizacja rezerwacji&#34;&#34;&#34;
    cur = self.conn.cursor()
    try:
        cur.execute(&#34;&#34;&#34;SELECT * FROM aktualizuj_rezerwacje()&#34;&#34;&#34;)
        self.conn.commit()
        message = (True, &#39;Pomyslnie zaktualizowano statusy rezerwacji&#39;)
    except psycopg2.errors.RaiseException as err:
        print(err)
        message = (False, self.handle_errors(err))
    except Exception as err:
        print(err)
        message = (False, self.handle_general_errors(err))
    cur.close()
    return message</code></pre>
</details>
</dd>
</dl>
</dd>
</dl>
</section>
</article>
<nav id="sidebar">
<h1>Index</h1>
<div class="toc">
<ul></ul>
</div>
<ul id="index">
<li><h3>Super-module</h3>
<ul>
<li><code><a title="Rezerwacje" href="index.html">Rezerwacje</a></code></li>
</ul>
</li>
<li><h3><a href="#header-classes">Classes</a></h3>
<ul>
<li>
<h4><code><a title="Rezerwacje.database.DataBase" href="#Rezerwacje.database.DataBase">DataBase</a></code></h4>
<ul class="">
<li><code><a title="Rezerwacje.database.DataBase.add_attraction" href="#Rezerwacje.database.DataBase.add_attraction">add_attraction</a></code></li>
<li><code><a title="Rezerwacje.database.DataBase.add_attraction_to_hotel" href="#Rezerwacje.database.DataBase.add_attraction_to_hotel">add_attraction_to_hotel</a></code></li>
<li><code><a title="Rezerwacje.database.DataBase.add_chain" href="#Rezerwacje.database.DataBase.add_chain">add_chain</a></code></li>
<li><code><a title="Rezerwacje.database.DataBase.add_employee" href="#Rezerwacje.database.DataBase.add_employee">add_employee</a></code></li>
<li><code><a title="Rezerwacje.database.DataBase.add_equipment" href="#Rezerwacje.database.DataBase.add_equipment">add_equipment</a></code></li>
<li><code><a title="Rezerwacje.database.DataBase.add_equipment_to_type" href="#Rezerwacje.database.DataBase.add_equipment_to_type">add_equipment_to_type</a></code></li>
<li><code><a title="Rezerwacje.database.DataBase.add_guest" href="#Rezerwacje.database.DataBase.add_guest">add_guest</a></code></li>
<li><code><a title="Rezerwacje.database.DataBase.add_guest_reservation" href="#Rezerwacje.database.DataBase.add_guest_reservation">add_guest_reservation</a></code></li>
<li><code><a title="Rezerwacje.database.DataBase.add_hotel" href="#Rezerwacje.database.DataBase.add_hotel">add_hotel</a></code></li>
<li><code><a title="Rezerwacje.database.DataBase.add_price_to_type" href="#Rezerwacje.database.DataBase.add_price_to_type">add_price_to_type</a></code></li>
<li><code><a title="Rezerwacje.database.DataBase.add_room" href="#Rezerwacje.database.DataBase.add_room">add_room</a></code></li>
<li><code><a title="Rezerwacje.database.DataBase.add_type" href="#Rezerwacje.database.DataBase.add_type">add_type</a></code></li>
<li><code><a title="Rezerwacje.database.DataBase.cancel_guest_reservation" href="#Rezerwacje.database.DataBase.cancel_guest_reservation">cancel_guest_reservation</a></code></li>
<li><code><a title="Rezerwacje.database.DataBase.change_guest_reservation" href="#Rezerwacje.database.DataBase.change_guest_reservation">change_guest_reservation</a></code></li>
<li><code><a title="Rezerwacje.database.DataBase.close_database" href="#Rezerwacje.database.DataBase.close_database">close_database</a></code></li>
<li><code><a title="Rezerwacje.database.DataBase.get_attractions" href="#Rezerwacje.database.DataBase.get_attractions">get_attractions</a></code></li>
<li><code><a title="Rezerwacje.database.DataBase.get_calculated_price" href="#Rezerwacje.database.DataBase.get_calculated_price">get_calculated_price</a></code></li>
<li><code><a title="Rezerwacje.database.DataBase.get_chains" href="#Rezerwacje.database.DataBase.get_chains">get_chains</a></code></li>
<li><code><a title="Rezerwacje.database.DataBase.get_employee" href="#Rezerwacje.database.DataBase.get_employee">get_employee</a></code></li>
<li><code><a title="Rezerwacje.database.DataBase.get_equipments" href="#Rezerwacje.database.DataBase.get_equipments">get_equipments</a></code></li>
<li><code><a title="Rezerwacje.database.DataBase.get_filtered_hotel_reservations" href="#Rezerwacje.database.DataBase.get_filtered_hotel_reservations">get_filtered_hotel_reservations</a></code></li>
<li><code><a title="Rezerwacje.database.DataBase.get_filtered_hotels" href="#Rezerwacje.database.DataBase.get_filtered_hotels">get_filtered_hotels</a></code></li>
<li><code><a title="Rezerwacje.database.DataBase.get_filtered_rooms" href="#Rezerwacje.database.DataBase.get_filtered_rooms">get_filtered_rooms</a></code></li>
<li><code><a title="Rezerwacje.database.DataBase.get_guest" href="#Rezerwacje.database.DataBase.get_guest">get_guest</a></code></li>
<li><code><a title="Rezerwacje.database.DataBase.get_guest_reservations" href="#Rezerwacje.database.DataBase.get_guest_reservations">get_guest_reservations</a></code></li>
<li><code><a title="Rezerwacje.database.DataBase.get_hotel_attractions" href="#Rezerwacje.database.DataBase.get_hotel_attractions">get_hotel_attractions</a></code></li>
<li><code><a title="Rezerwacje.database.DataBase.get_hotel_reservations" href="#Rezerwacje.database.DataBase.get_hotel_reservations">get_hotel_reservations</a></code></li>
<li><code><a title="Rezerwacje.database.DataBase.get_hotel_statistics" href="#Rezerwacje.database.DataBase.get_hotel_statistics">get_hotel_statistics</a></code></li>
<li><code><a title="Rezerwacje.database.DataBase.get_hotels" href="#Rezerwacje.database.DataBase.get_hotels">get_hotels</a></code></li>
<li><code><a title="Rezerwacje.database.DataBase.get_room_availability" href="#Rezerwacje.database.DataBase.get_room_availability">get_room_availability</a></code></li>
<li><code><a title="Rezerwacje.database.DataBase.get_room_equipments" href="#Rezerwacje.database.DataBase.get_room_equipments">get_room_equipments</a></code></li>
<li><code><a title="Rezerwacje.database.DataBase.get_rooms" href="#Rezerwacje.database.DataBase.get_rooms">get_rooms</a></code></li>
<li><code><a title="Rezerwacje.database.DataBase.get_statistics" href="#Rezerwacje.database.DataBase.get_statistics">get_statistics</a></code></li>
<li><code><a title="Rezerwacje.database.DataBase.get_status" href="#Rezerwacje.database.DataBase.get_status">get_status</a></code></li>
<li><code><a title="Rezerwacje.database.DataBase.get_types" href="#Rezerwacje.database.DataBase.get_types">get_types</a></code></li>
<li><code><a title="Rezerwacje.database.DataBase.handle_errors" href="#Rezerwacje.database.DataBase.handle_errors">handle_errors</a></code></li>
<li><code><a title="Rezerwacje.database.DataBase.handle_general_errors" href="#Rezerwacje.database.DataBase.handle_general_errors">handle_general_errors</a></code></li>
<li><code><a title="Rezerwacje.database.DataBase.input_from_file" href="#Rezerwacje.database.DataBase.input_from_file">input_from_file</a></code></li>
<li><code><a title="Rezerwacje.database.DataBase.login_user" href="#Rezerwacje.database.DataBase.login_user">login_user</a></code></li>
<li><code><a title="Rezerwacje.database.DataBase.logout" href="#Rezerwacje.database.DataBase.logout">logout</a></code></li>
<li><code><a title="Rezerwacje.database.DataBase.pay_guest_reservation" href="#Rezerwacje.database.DataBase.pay_guest_reservation">pay_guest_reservation</a></code></li>
<li><code><a title="Rezerwacje.database.DataBase.update_employee" href="#Rezerwacje.database.DataBase.update_employee">update_employee</a></code></li>
<li><code><a title="Rezerwacje.database.DataBase.update_guest" href="#Rezerwacje.database.DataBase.update_guest">update_guest</a></code></li>
<li><code><a title="Rezerwacje.database.DataBase.update_reservations" href="#Rezerwacje.database.DataBase.update_reservations">update_reservations</a></code></li>
</ul>
</li>
</ul>
</li>
</ul>
</nav>
</main>
<footer id="footer">
<p>Generated by <a href="https://pdoc3.github.io/pdoc"><cite>pdoc</cite> 0.9.2</a>.</p>
</footer>
</body>
</html>
